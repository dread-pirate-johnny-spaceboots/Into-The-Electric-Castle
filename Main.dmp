00001  0000             ; 10 SYS (2080)
00002  0001             
00003  0001             *=$0801
00004  0801             
00005  0801  0E 08 0A              BYTE    $0E, $08, $0A, $00, $9E, $20, $28,  $32, $30, $38, $30, $29, $00, $00, $00
00006  0810             
00007  0810             ; SCREEN
00008  0810             TEXT_COLOUR = $0286
00009  0810             BORDER_COLOUR = $D020
00010  0810             BG_COLOUR  = $D021
00011  0810             BG_COLOUR1 = $D022
00012  0810             BG_COLOUR2 = $D023
00013  0810             BG_COLOUR3 = $D024
00014  0810             RASTER_LINE = $D012
00015  0810             SCREEN_CONTROL1 = $D011
00016  0810             SCREEN_CONTROL = $D016
00017  0810             SCREEN_BLOCK1 = $0400
00018  0810             SCREEN_BLOCK2 = $04FF
00019  0810             SCREEN_BLOCK3 = $05FE
00020  0810             SCREEN_BLOCK4 = $06FD
00021  0810             PLAYER_LIVES_POSITION = $07C9
00022  0810             
00023  0810             ; ACTION SELECTOR BOX CORNERS
00024  0810             ; BOX 1 - SHOOT
00025  0810             ACTION_SELECTOR_POS1 = $0795
00026  0810             ACTION_SELECTOR_POS2 = $0797
00027  0810             ACTION_SELECTOR_POS3 = $07E5
00028  0810             ACTION_SELECTOR_POS4 = $07E7
00029  0810             ; BOX 2 - TALK
00030  0810             ACTION_SELECTOR_POS5 = $0745
00031  0810             ACTION_SELECTOR_POS6 = $0747
00032  0810             ACTION_SELECTOR_POS7 = $0795
00033  0810             ACTION_SELECTOR_POS8 = $0797
00034  0810             ; BOX 3 - USE
00035  0810             ACTION_SELECTOR_POS9 = $06F5
00036  0810             ACTION_SELECTOR_POS10 = $06F7
00037  0810             ACTION_SELECTOR_POS11 = $0745
00038  0810             ACTION_SELECTOR_POS12 = $0747
00039  0810             
00040  0810             ; BUILTIN SUBROUTINES
00041  0810             CHAROUT    = $FFD2
00042  0810             STROUT     = $AB1E
00043  0810             
00044  0810             ; JOYSTICK
00045  0810             JOYSTICK_PORT1 = $DC01
00046  0810             JOYSTICK_PORT2 = $DC00
00047  0810             
00048  0810             ; SPRITES
00049  0810             SPRITE_ENABLED = $D015;
00050  0810             SPRITE_MULTICOLOUR_ENABLE=$D01C 
00051  0810             SPRITE_OVERFLOW = $D010
00052  0810             SPRITE_BG_COLLISION = $D01F
00053  0810             SPRITE_COLLISIONS = $D01E
00054  0810             
00055  0810             SPRITE0_X  = $D000
00056  0810             SPRITE0_Y  = $D001
00057  0810             SPRITE0_COLOUR = $D027
00058  0810             SPRITE0_DATA = $2000
00059  0810             SPRITE0_POINTER = $07F8
00060  0810             
00061  0810             SPRITE1_X  = $D002
00062  0810             SPRITE1_Y  = $D003
00063  0810             SPRITE1_COLOUR = $D028
00064  0810             SPRITE1_DATA = $24C0
00065  0810             SPRITE1_POINTER = $07F9
00066  0810             
00067  0810             SPRITE2_X  = $D004
00068  0810             SPRITE2_Y  = $D005
00069  0810             SPRITE2_COLOUR = $D029
00070  0810             SPRITE2_POINTER = $07FA
00071  0810             DOOR_SPRITE_DATA=$2700 
00072  0810             
00073  0810             SPRITE3_X  = $D006
00074  0810             SPRITE3_Y  = $D007
00075  0810             SPRITE3_COLOUR=$D02A 
00076  0810             SPRITE3_POINTER=$07FB 
00077  0810             SPRITE3_DATA=$2840 
00078  0810             
00079  0810             SPRITE4_X  = $D008
00080  0810             SPRITE4_Y  = $D009
00081  0810             SPRITE4_COLOUR=$D02B 
00082  0810             SPRITE4_POINTER=$07FC 
00083  0810             SPRITE4_DATA=$2980 
00084  0810             
00085  0810             SPRITE5_X  = $D00A
00086  0810             SPRITE5_Y  = $D00B
00087  0810             SPRITE5_COLOUR = $D02C
00088  0810             SPRITE5_POINTER = $07FD
00089  0810             SPRITE5_DATA = $2980
00090  0810             
00091  0810             SPRITE6_X  = $D00C
00092  0810             SPRITE6_Y  = $D00D
00093  0810             SPRITE6_COLOUR = $D02D
00094  0810             SPRITE6_POINTER = $07FE
00095  0810             SPRITE6_DATA = $2000
00096  0810             
00097  0810             SPRITE7_X  = $D00E
00098  0810             SPRITE7_Y  = $D00F
00099  0810             SPRITE7_COLOUR = $D02E
00100  0810             SPRITE7_POINTER = $07FF
00101  0810             SPRITE7_DATA = $2000
00102  0810             
00103  0810             
00104  0810             ; CHARACTER SET
00105  0810             CHARSET=$3800 
00106  0810             FOREVER_CHARSET=$3000 
00107  0810             CHARSET_LOOKUP = $D018
00108  0810             
00109  0810             ; TITLE SCREEN
00110  0810             TITLE_BLOCK1 = $5400
00111  0810             TITLE_BLOCK2 = $54FF
00112  0810             TITLE_BLOCK3 = $55FE
00113  0810             TITLE_BLOCK4 = $56FD
00114  0810             
00115  0810             ; FOREVER SCREEN (GAMEOVER / NEXT LEVEL / END)
00116  0810             FOREVER_BLOCK1 = $5800
00117  0810             FOREVER_BLOCK2 = $58FF
00118  0810             FOREVER_BLOCK3 = $59FE
00119  0810             FOREVER_BLOCK4 = $5AFD
00120  0810             
00121  0810             ; LEVELS
00122  0810             LEVEL1_BLOCK1 = $5000
00123  0810             LEVEL1_BLOCK2 = $50FF
00124  0810             LEVEL1_BLOCK3 = $51FE
00125  0810             LEVEL1_BLOCK4 = $52FD
00126  0810             
00127  0810             ; PLAYER
00128  0810             PLAYER_DYING_COUNTER = $7000
00129  0810             PLAYER_LIVES = $7001
00130  0810             PLAYER_MOVED_THIS_FRAME = $7002
00131  0810             PLAYER_CURRENT_ACTION = $7003
00132  0810             PLAYER_ACTION_SWITCH_COOLDOWN = $7004
00133  0810             PLAYER_BULLET_DIRECTION = $7005
00134  0810             PLAYER_BULLET_EXPLOSION_COUNTER = $7006
00135  0810             DOOR1_OPEN_COUNTER = $7007
00136  0810             DOOR2_OPEN_COUNTER = $7008
00137  0810             LEVEL1_TILE_COUNTER=$7009 
00138  0810             
00139  0810             ; SOUND
00140  0810             SID_VOICE1_LO_FREQ = $D400
00141  0810             SID_VOICE1_HI_FREQ = $D401
00142  0810             SID_VOICE1_CONTROL = $D404
00143  0810             SID_ATTACK_DECAY = $D405
00144  0810             SID_SUSTAIN = $D406
00145  0810             SID_PULSE_LO_WIDTH = $D402
00146  0810             SID_PULSE_HI_WIDTH = $D403
00147  0810             SID_VOLUME = $D418
00148  0810             
00149  0810             *=SPRITE0_DATA 
00150  2000             INCBIN     "PLAYERSPRITES.BIN"
00151  24C0             
00152  24C0             *=SPRITE1_DATA 
00153  24C0             INCBIN     "BULLET.BIN"
00154  2700             
00155  2700             *=CHARSET
00156  3800             INCBIN     "LEVELGEO.BIN"
00157  4800             
00158  4800             *=FOREVER_CHARSET 
00159  3000             INCBIN     "FOREVERCHARSET.BIN"
00160  3400             
00161  3400             *=TITLE_BLOCK1 
00162  5400             INCBIN     "TITLE.BIN"
00163  57E8             
00164  57E8             *=LEVEL1_BLOCK1 
00165  5000             INCBIN     "LEVEL1.BIN"
00166  53E8             
00167  53E8             *=FOREVER_BLOCK1 
00168  5800             INCBIN     "FOREVEROFTHESTARS.BIN"
00169  5BE8             
00170  5BE8             *=DOOR_SPRITE_DATA 
00171  2700             INCBIN     "DOOR.BIN"
00172  2980             
00173  2980             *=SPRITE4_DATA 
00174  2980             INCBIN     "BUTTON.BIN"
00175  2A40             
00176  2A40             DEFM       WAITFORRASTER
00177  2A40             @RASTERLOOP 
00178  2A40                        LDA /1
00179  2A40                        CMP RASTER_LINE
00180  2A40                        BNE @RASTERLOOP
00181  2A40             ENDM
00182  2A40             
00183  2A40             DEFM       ENABLESPRITES
00184  2A40                        LDA /1
00185  2A40                        STA SPRITE_ENABLED
00186  2A40                        
00187  2A40             ENDM
00188  2A40             
00189  2A40             DEFM       ENABLESPRITE
00190  2A40                        LDA SPRITE_ENABLED
00191  2A40                        ORA /1
00192  2A40                        STA SPRITE_ENABLED
00193  2A40             ENDM
00194  2A40             
00195  2A40             DEFM       DISABLESPRITE
00196  2A40                        LDA SPRITE_ENABLED
00197  2A40                        AND /1
00198  2A40                        STA SPRITE_ENABLED
00199  2A40             ENDM
00200  2A40             
00201  2A40             DEFM       POINTTOSPRITEDATA
00202  2A40                        LDA /1
00203  2A40                        STA /2
00204  2A40             ENDM
00205  2A40             
00206  2A40             DEFM       DRAWSCREEN
00207  2A40                        LDX #0
00208  2A40             @BLOCK1
00209  2A40                        LDA /1,X
00210  2A40                        TAY
00211  2A40                        STA SCREEN_BLOCK1,X
00212  2A40                        INX
00213  2A40                        CPX #255
00214  2A40                        BNE @BLOCK1
00215  2A40                        LDX #0
00216  2A40             @BLOCK2
00217  2A40                        LDA /2,X
00218  2A40                        TAY
00219  2A40                        STA SCREEN_BLOCK2,X
00220  2A40                        INX
00221  2A40                        CPX #255
00222  2A40                        BNE @BLOCK2
00223  2A40                        LDX #0
00224  2A40             @BLOCK3
00225  2A40                        LDA /3,X
00226  2A40                        TAY
00227  2A40                        STA SCREEN_BLOCK3,X
00228  2A40                        INX
00229  2A40                        CPX #255
00230  2A40                        BNE @BLOCK3
00231  2A40                        LDX #0
00232  2A40             @BLOCK4
00233  2A40                        LDA /4,X
00234  2A40                        TAY
00235  2A40                        STA SCREEN_BLOCK4,X
00236  2A40                        INX
00237  2A40                        CPX #255
00238  2A40                        BNE @BLOCK4
00239  2A40                        LDX #0
00240  2A40                        RTS
00241  2A40             ENDM
00242  2A40             
00243  2A40             DEFM       PRINTCHAR
00244  2A40                        LDA /1
00245  2A40                        JSR CHAROUT
00246  2A40                        RTS
00247  2A40             ENDM
00248  2A40             
00249  2A40             DEFM       PRINTSTR
00250  2A40                        LDX #0
00251  2A40                        LDY #0
00252  2A40             @LOOP
00253  2A40                        LDA #255
00254  2A40                        CMP RASTER_LINE
00255  2A40                        BNE @LOOP
00256  2A40                        LDA /1,X
00257  2A40                        STA $0400,X+/3
00258  2A40                        INX
00259  2A40                        CPX /2
00260  2A40                        BNE @LOOP
00261  2A40             ENDM
00262  2A40             
00263  2A40             DEFM       PLAYSOUND
00264  2A40                        LDA /1
00265  2A40                        STA SID_VOLUME
00266  2A40                        LDA /2
00267  2A40                        STA SID_VOICE1_LO_FREQ
00268  2A40                        LDA /3
00269  2A40                        STA SID_VOICE1_HI_FREQ
00270  2A40                        LDA /4
00271  2A40                        STA SID_ATTACK_DECAY
00272  2A40                        LDA /5
00273  2A40                        STA SID_SUSTAIN
00274  2A40                        LDA #0
00275  2A40                        STA SID_VOICE1_CONTROL
00276  2A40                        LDA /6
00277  2A40                        STA SID_VOICE1_CONTROL
00278  2A40             ENDM
00279  2A40             
00280  2A40             DEFM       STORELEVEL1TILES
00281  2A40                        ;STA $0527
00282  2A40                        ;STA $04DB
00283  2A40                        ;STA $052F
00284  2A40                        ;STA $05F9
00285  2A40                        ;STA $0645
00286  2A40                        ;STA $05F1
00287  2A40                        ;STA $063D
00288  2A40             ENDM
00289  2A40             
00290  2A40             ; PARAMETER MUST BE XXX00000
00291  2A40             DEFM       SETCHARACTERSET
00292  2A40                        LDA CHARSET_LOOKUP
00293  2A40                        AND #%11111000
00294  2A40                        ORA /1
00295  2A40                        STA CHARSET_LOOKUP
00296  2A40             ENDM
00297  2A40             
00298  2A40             DEFM       DISABLEMULTICOLORMODE
00299  2A40                        LDA SCREEN_CONTROL
00300  2A40                        AND #$EF
00301  2A40                        STA SCREEN_CONTROL
00302  2A40             ENDM
00303  2A40             
00304  2A40             DEFM       ENABLEMULTICOLORMODE
00305  2A40                        LDA SCREEN_CONTROL
00306  2A40                        ORA #$10
00307  2A40                        STA SCREEN_CONTROL
00308  2A40             ENDM
00309  2A40             
00310  2A40             DEFM       SETTEXTCOLOR
00311  2A40                        LDA /1
00312  2A40                        STA TEXT_COLOUR
00313  2A40             ENDM
00314  2A40             
00315  2A40             DEFM       SETBACKGROUNDCOLOR
00316  2A40                        LDA /1
00317  2A40                        STA BG_COLOUR
00318  2A40             ENDM
00319  2A40             
00320  2A40             DEFM       SETBACKGROUNDCOLOR1
00321  2A40                        LDA /1
00322  2A40                        STA BG_COLOUR1
00323  2A40             ENDM
00324  2A40             
00325  2A40             DEFM       SETBACKGROUNDCOLOR2
00326  2A40                        LDA /1
00327  2A40                        STA BG_COLOUR2
00328  2A40             ENDM
00329  2A40             
00330  2A40             DEFM       SETBACKGROUNDCOLOR3
00331  2A40                        LDA /1
00332  2A40                        STA BG_COLOUR3
00333  2A40             ENDM
00334  2A40             
00335  2A40             DEFM       SETBACKGROUNDCOLORS
00336  2A40                        LDA /1
00337  2A40                        STA BG_COLOUR
00338  2A40                        LDA /2
00339  2A40                        STA BG_COLOUR1
00340  2A40                        LDA /3
00341  2A40                        STA BG_COLOUR2
00342  2A40                        LDA /4
00343  2A40                        STA BG_COLOUR3
00344  2A40             ENDM
00345  2A40             
00346  2A40             ;INITCHARACTERSET
00347  2A40             ;        LDA CHARSET_LOOKUP
00348  2A40             ;        ORA #$R
00349  2A40             ;        STA CHARSET_LOOKUP
00350  2A40             ;        LDA SCREEN_CONTROL
00351  2A40             ;        ORA #%00010000
00352  2A40             ;        STA SCREEN_CONTROL
00353  2A40             ;        LDA COLOUR_LIGHT_BLUE
00354  2A40             ;        STA BG_COLOUR1
00355  2A40             ;        LDA COLOUR_WHITE
00356  2A40             ;        STA BG_COLOUR2
00357  2A40             ;        LDA COLOUR_RED
00358  2A40             ;        STA BG_COLOUR3
00359  2A40             ;        RTS
00360  2A40             
00361  2A40             ; JOYSTICK
00362  2A40             JOYSTICK_INPUT = $02
00363  2A40             JOYSTICK_INPUT1 = $02
00364  2A40             JOYSTICK_MASK_RIGHT = %00001000
00365  2A40             JOYSTICK_MASK_LEFT = %00000100
00366  2A40             JOYSTICK_MASK_UP = %00000001
00367  2A40             JOYSTICK_MASK_DOWN = %00000010
00368  2A40             JOYSTICK_MASK_BTN = %00010000
00369  2A40             
00370  2A40             ; UI
00371  2A40  70         BOX_SELECTOR_TL BYTE $70
00372  2A41  6E         BOX_SELECTOR_TR BYTE $6E
00373  2A42  6D         BOX_SELECTOR_BL BYTE $6D
00374  2A43  7D         BOX_SELECTOR_BR BYTE $7D
00375  2A44             
00376  2A44             ; PLAYER
00377  2A44  80         PLAYER_SPRITE_INDEX BYTE $80
00378  2A45  15         PLAYER_X   BYTE $15
00379  2A46  32         PLAYER_Y   BYTE $32
00380  2A47             PLAYER_ACTION = #1
00381  2A47             PLAYER_MOVED_UP = #2
00382  2A47             PLAYER_MOVED_RIGHT = #4
00383  2A47             PLAYER_MOVED_DOWN = #8
00384  2A47             PLAYER_MOVED_LEFT = #16
00385  2A47  80         PLAYER_IDLE BYTE $80
00386  2A48  81         PLAYER_RIGHT BYTE $81
00387  2A49  83         PLAYER_LEFT BYTE $83
00388  2A4A  85         PLAYER_UP  BYTE $85
00389  2A4B  87         PLAYER_DOWN BYTE $87
00390  2A4C             
00391  2A4C             ; PLAYER ACTIONS
00392  2A4C             PLAYER_ACTION_SHOOT = #%00000001
00393  2A4C             PLAYER_ACTION_TALK = #%00000010
00394  2A4C             PLAYER_ACTION_USE = #%00000100
00395  2A4C             
00396  2A4C             ; PLAYER BULLET
00397  2A4C  93         PLAYER_BULLET_SPRITE_INDEX BYTE $93
00398  2A4D  15         PLAYER_BULLET_X BYTE $15
00399  2A4E  32         PLAYER_BULLET_Y BYTE $32
00400  2A4F  93         PLAYER_BULLET_HORI BYTE $93
00401  2A50  94         PLAYER_BULLET_VERT BYTE $94
00402  2A51  95         PLAYER_BULLET_NWSE BYTE $95
00403  2A52  96         PLAYER_BULLET_SWNE BYTE $96
00404  2A53  97         PLAYER_BULLET_EXPLOSION1 BYTE $97
00405  2A54  98         PLAYER_BULLET_EXPLOSION2 BYTE $98
00406  2A55  99         PLAYER_BULLET_EXPLOSION3 BYTE $99
00407  2A56  9A         PLAYER_BULLET_EXPLOSION4 BYTE $9A
00408  2A57  9B         PLAYER_BULLET_EXPLOSION5 BYTE $9B
00409  2A58             
00410  2A58             ;DOOR
00411  2A58  9C         DOOR_SPRITE_INDEX BYTE $9C
00412  2A59  F8         DOOR_X     BYTE $F8
00413  2A5A  B3         DOOR_Y     BYTE $B3
00414  2A5B  9C         DOOR_FRAME1 BYTE $9C
00415  2A5C  9D         DOOR_FRAME2 BYTE $9D
00416  2A5D  9E         DOOR_FRAME3 BYTE $9E
00417  2A5E  9F         DOOR_FRAME4 BYTE $9F
00418  2A5F  A0         DOOR_FRAME5 BYTE $A0
00419  2A60             
00420  2A60             ;HORIZONTAL DOOR
00421  2A60  A1         HORI_DOOR_SPRITE_INDEX BYTE $A1
00422  2A61  0F         HORI_DOOR_X BYTE $0F
00423  2A62  A2         HORI_DOOR_Y BYTE $A2
00424  2A63  A1         HORI_DOOR_FRAME1 BYTE $A1
00425  2A64  A2         HORI_DOOR_FRAME2 BYTE $A2
00426  2A65  A3         HORI_DOOR_FRAME3 BYTE $A3
00427  2A66  A4         HORI_DOOR_FRAME4 BYTE $A4
00428  2A67  A5         HORI_DOOR_FRAME5 BYTE $A5
00429  2A68             
00430  2A68             ; BUTTON
00431  2A68  A6         BUTTON_SPRITE_INDEX BYTE $A6
00432  2A69  F1         BUTTON_X   BYTE $F1
00433  2A6A  DA         BUTTON_Y   BYTE $DA
00434  2A6B  A6         BUTTON_FRAME1 BYTE $A6
00435  2A6C  A7         BUTTON_FRAME2 BYTE $A7
00436  2A6D  A8         BUTTON_FRAME3 BYTE $A8
00437  2A6E             
00438  2A6E  A6         BUTTON2_SPRITE_INDEX BYTE $A6
00439  2A6F  00         BUTTON2_X  BYTE $0
00440  2A70  80         BUTTON2_Y  BYTE $80
00441  2A71  A6         BUTTON2_FRAME1 BYTE $A6
00442  2A72  A7         BUTTON2_FRAME2 BYTE $A7
00443  2A73  A8         BUTTON2_FRAME3 BYTE $A8
00444  2A74             
00445  2A74             ; NPCS
00446  2A74  80         NPC1_SPRITE_INDEX BYTE $80
00447  2A75  80         NPC2_SPRITE_INDEX BYTE $80
00448  2A76  52         NPC1_X     BYTE $52
00449  2A77  D7         NPC1_Y     BYTE $D7
00450  2A78  0F         NPC2_X     BYTE $0F
00451  2A79  80         NPC2_Y     BYTE $80
00452  2A7A             
00453  2A7A             ; ANIMATION
00454  2A7A             PLAYER_RIGHT_ANIM1 = #$81
00455  2A7A             PLAYER_RIGHT_ANIM2 = #$82
00456  2A7A             PLAYER_LEFT_ANIM1 = #$83
00457  2A7A             PLAYER_LEFT_ANIM2 = #$84
00458  2A7A             PLAYER_UP_ANIM1 = #$85
00459  2A7A             PLAYER_UP_ANIM2 = #$86
00460  2A7A             PLAYER_DOWN_ANIM1 = #$87
00461  2A7A             PLAYER_DOWN_ANIM2 = #$88
00462  2A7A             PLAYER_DYING_ANIM1 = #$89
00463  2A7A             PLAYER_DYING_ANIM2 = #$8A
00464  2A7A             PLAYER_SHOOT_N = #$8B
00465  2A7A             PLAYER_SHOOT_NE = #$8C
00466  2A7A             PLAYER_SHOOT_E = #$8D
00467  2A7A             PLAYER_SHOOT_SE = #$8E
00468  2A7A             PLAYER_SHOOT_S = #$8F
00469  2A7A             PLAYER_SHOOT_SW = #$90
00470  2A7A             PLAYER_SHOOT_W = #$91
00471  2A7A             PLAYER_SHOOT_NW = #$92
00472  2A7A             
00473  2A7A             ; COLOURS
00474  2A7A             COLOUR_BLACK = #0
00475  2A7A             COLOUR_WHITE = #1
00476  2A7A             COLOUR_RED = #2
00477  2A7A             COLOUR_CYAN = #3
00478  2A7A             COLOUR_LIGHT_BLUE = #14
00479  2A7A             
00480  2A7A             *=$0820
00481  0820  A2 00                 LDX #00
00482  0822  8E 07 70              STX DOOR1_OPEN_COUNTER
00483  0825  8E 08 70              STX DOOR2_OPEN_COUNTER
00484  0828  8E 20 D0              STX BORDER_COLOUR
00485  082B  8E 09 70              STX LEVEL1_TILE_COUNTER
00486  082E  8E 06 70              STX PLAYER_BULLET_EXPLOSION_COUNTER
00487  0831  A2 01                 LDX #1
00488  0833  8E 00 70              STX PLAYER_DYING_COUNTER
00489  0836  A2 00                 LDX COLOUR_BLACK
00490  0838  8E 21 D0              STX BG_COLOUR
00491  083B  20 E5 0A              JSR CLEARSCREEN
00492  083E  20 6D 0E              JSR DRAWTITLE
00493  0841  20 0C 0E              JSR INITCHARACTERSET
00494  0844  20 68 0F              JSR INITPLAYERSTATE
00495  0847             TITLELOOP
00496  0847  20 EB 0A              JSR READJOYSTICK
00497  084A  A5 02                 LDA JOYSTICK_INPUT
00498  084C  29 01                 AND PLAYER_ACTION
00499  084E  D0 03                 BNE INITGAME
00500  0850  4C 47 08              JMP TITLELOOP
00501  0853             INITGAME
00502  0853  A2 00                 LDX COLOUR_BLACK
00503  0855  8E 21 D0              STX BG_COLOUR
00504  0858  A2 0E                 LDX COLOUR_LIGHT_BLUE
00505  085A  8E 86 02              STX TEXT_COLOUR
00506  085D  20 E5 0A              JSR CLEARSCREEN
00507  0860  20 31 0E              JSR DRAWLEVEL
00508  0863  20 4B 0D              JSR INITSPRITES
00509  0866             GAMELOOP
00510  0866             
00511  0866             
00512  0866             @RASTERLOOP 
00513  0866  A9 FF                 LDA #255
00514  0868  CD 12 D0              CMP RASTER_LINE
00515  086B  D0 F9                 BNE @RASTERLOOP
00516  086D  A2 00                 LDX #0
00517  086F  8E 02 70              STX PLAYER_MOVED_THIS_FRAME
00518  0872  AD 00 70              LDA PLAYER_DYING_COUNTER
00519  0875  C9 00                 CMP #0
00520  0877  D0 66                 BNE @HANDLEDYING
00521  0879  20 EB 0A              JSR READJOYSTICK
00522  087C  20 78 0C              JSR UPDATEPLAYERANIMATIONFRAME
00523  087F  20 E2 0D              JSR UPDATEPLAYERSPRITE
00524  0882  20 A9 0B              JSR MOVEPLAYER
00525  0885  20 E3 0C              JSR UPDATEPLAYERSPRITEPOSITION
00526  0888  20 D6 0E              JSR CHECKFORWALLCOLLISION
00527  088B  20 E4 0E              JSR CHECKFORSPRITECOLLISION
00528  088E  20 F0 0C              JSR UPDATEPLAYERBULLETPOSITION
00529  0891  20 FA 12              JSR HANDLEBULLETEXPLOSION
00530  0894  AD 01 70              LDA PLAYER_LIVES
00531  0897  09 30                 ORA #48
00532  0899  8D C9 07              STA PLAYER_LIVES_POSITION
00533  089C                        
00534  089C  AD 07 70              LDA DOOR1_OPEN_COUNTER
00535  089F  C9 00                 CMP #0
00536  08A1  D0 65                 BNE @HANDLEDOOR1OPEN
00537  08A3             
00538  08A3  AD 08 70              LDA DOOR2_OPEN_COUNTER
00539  08A6  C9 00                 CMP #0
00540  08A8  D0 25                 BNE @OPEND2
00541  08AA             
00542  08AA  20 4A 0B              JSR READJOYSTICK1
00543  08AD  20 AD 10              JSR CHECKFORSELECTEDACTIONCHANGE
00544  08B0             
00545  08B0  AD 02 70              LDA PLAYER_MOVED_THIS_FRAME
00546  08B3  C9 01                 CMP #$1
00547  08B5  D0 07                 BNE @ACTIONSWITCH
00548  08B7  20 95 11              JSR CHECKFORACTION ; HANDLES MOVING THE BULLET IN CASES WHERE NO ACTION WAS PROCESSES. TODO: RENAME
00549  08BA                        ;JMP RESETLOOP
00550  08BA  4C 66 08              JMP GAMELOOP
00551  08BD  60                    RTS
00552  08BE             @ACTIONSWITCH 
00553  08BE  AD 03 70              LDA PLAYER_CURRENT_ACTION
00554  08C1  C9 01                 CMP PLAYER_ACTION_SHOOT
00555  08C3  F0 0E                 BEQ @HANDLEACTION
00556  08C5  C9 02                 CMP PLAYER_ACTION_TALK
00557  08C7  F0 03                 BEQ @TRIGGERTALK
00558  08C9                        
00559  08C9  4C 66 08              JMP GAMELOOP
00560  08CC             @TRIGGERTALK 
00561  08CC  4C 71 13              JMP HANDLETALK
00562  08CF             @OPEND2
00563  08CF  4C 85 0A              JMP HANDLEDOOR2OPEN
00564  08D2  60                    RTS
00565  08D3             @HANDLEACTION 
00566  08D3  20 4A 0B              JSR READJOYSTICK1
00567  08D6  20 0F 10              JSR HANDLEACTION
00568  08D9  20 E2 0D              JSR UPDATEPLAYERSPRITE
00569  08DC  4C 66 08              JMP GAMELOOP
00570  08DF             @HANDLEDYING 
00571  08DF  20 9C 0F              JSR PLAYZAP
00572  08E2  20 E2 0D              JSR UPDATEPLAYERSPRITE
00573  08E5  AE 00 70              LDX PLAYER_DYING_COUNTER
00574  08E8  E0 40                 CPX #64
00575  08EA  F0 7C                 BEQ @CHECKLIVES
00576  08EC  E8                    INX
00577  08ED  8E 00 70              STX PLAYER_DYING_COUNTER
00578  08F0  AD 44 2A              LDA PLAYER_SPRITE_INDEX
00579  08F3  C9 8A                 CMP PLAYER_DYING_ANIM2
00580  08F5  F0 08                 BEQ @DYINGFRAME1
00581  08F7  A2 8A                 LDX PLAYER_DYING_ANIM2
00582  08F9  8E 44 2A              STX PLAYER_SPRITE_INDEX
00583  08FC  4C 66 08              JMP GAMELOOP
00584  08FF             @DYINGFRAME1 
00585  08FF  A2 89                 LDX PLAYER_DYING_ANIM1
00586  0901  8E 44 2A              STX PLAYER_SPRITE_INDEX
00587  0904  4C 66 08              JMP GAMELOOP
00588  0907  60                    RTS
00589  0908             @HANDLEDOOR1OPEN 
00590  0908  AD 07 70              LDA DOOR1_OPEN_COUNTER
00591  090B  AA                    TAX
00592  090C  E8                    INX
00593  090D  8E 07 70              STX DOOR1_OPEN_COUNTER
00594  0910  C9 01                 CMP #1
00595  0912  F0 14                 BEQ @DOOR1OPENFRAME1
00596  0914  C9 02                 CMP #2
00597  0916  F0 1C                 BEQ @DOOR1OPENFRAME2
00598  0918  C9 03                 CMP #3
00599  091A  F0 24                 BEQ @DOOR1OPENFRAME3
00600  091C  C9 04                 CMP #4
00601  091E  F0 2C                 BEQ @DOOR1OPENFRAME4
00602  0920  C9 05                 CMP #5
00603  0922  F0 34                 BEQ @DESTROYDOOR1
00604  0924  4C 66 08              JMP GAMELOOP
00605  0927  60                    RTS
00606  0928             @DOOR1OPENFRAME1 
00607  0928  AD 5C 2A              LDA DOOR_FRAME2
00608  092B  8D 58 2A              STA DOOR_SPRITE_INDEX
00609  092E  20 F0 0D              JSR UPDATEDOORSPRITE
00610  0931  4C 66 08              JMP GAMELOOP
00611  0934             @DOOR1OPENFRAME2 
00612  0934  AD 5D 2A              LDA DOOR_FRAME3
00613  0937  8D 58 2A              STA DOOR_SPRITE_INDEX
00614  093A  20 F0 0D              JSR UPDATEDOORSPRITE
00615  093D  4C 66 08              JMP GAMELOOP
00616  0940             @DOOR1OPENFRAME3 
00617  0940  AD 5E 2A              LDA DOOR_FRAME4
00618  0943  8D 58 2A              STA DOOR_SPRITE_INDEX
00619  0946  20 F0 0D              JSR UPDATEDOORSPRITE
00620  0949  4C 66 08              JMP GAMELOOP
00621  094C             @DOOR1OPENFRAME4 
00622  094C  AD 5F 2A              LDA DOOR_FRAME5
00623  094F  8D 58 2A              STA DOOR_SPRITE_INDEX
00624  0952  20 F0 0D              JSR UPDATEDOORSPRITE
00625  0955  4C 66 08              JMP GAMELOOP
00626  0958             @DESTROYDOOR1 
00627  0958             
00628  0958             
00629  0958  AD 15 D0              LDA SPRITE_ENABLED
00630  095B  29 FB                 AND #%11111011
00631  095D  8D 15 D0              STA SPRITE_ENABLED
00632  0960  A2 00                 LDX #0
00633  0962  8E 07 70              STX DOOR1_OPEN_COUNTER
00634  0965  4C 66 08              JMP GAMELOOP
00635  0968             @CHECKLIVES 
00636  0968  AE 01 70              LDX PLAYER_LIVES
00637  096B  E0 00                 CPX #0
00638  096D  F0 20                 BEQ @GAMEOVER
00639  096F             @RESPAWN
00640  096F  AD 10 D0              LDA SPRITE_OVERFLOW
00641  0972  29 FE                 AND #%11111110
00642  0974  8D 10 D0              STA SPRITE_OVERFLOW
00643  0977  A2 4A                 LDX #$4A
00644  0979  8E 45 2A              STX PLAYER_X
00645  097C  A2 5E                 LDX #$5E
00646  097E  8E 46 2A              STX PLAYER_Y
00647  0981  A2 00                 LDX #0
00648  0983  8E 00 70              STX PLAYER_DYING_COUNTER
00649  0986  AE 47 2A              LDX PLAYER_IDLE
00650  0989  8E 44 2A              STX PLAYER_SPRITE_INDEX
00651  098C  4C 66 08              JMP GAMELOOP
00652  098F             @GAMEOVER
00653  098F  20 E5 0A              JSR CLEARSCREEN
00654  0992             
00655  0992             
00656  0992  A9 00                 LDA #%00000000
00657  0994  8D 15 D0              STA SPRITE_ENABLED
00658  0997                        
00659  0997  A9 00                 LDA COLOUR_BLACK
00660  0999  8D 86 02              STA TEXT_COLOUR
00661  099C  A9 02                 LDA COLOUR_RED
00662  099E  8D 21 D0              STA BG_COLOUR
00663  09A1             
00664  09A1             
00665  09A1  A2 00                 LDX #0
00666  09A3  A0 00                 LDY #0
00667  09A5             @LOOP
00668  09A5  A9 FF                 LDA #255
00669  09A7  CD 12 D0              CMP RASTER_LINE
00670  09AA  D0 F9                 BNE @LOOP
00671  09AC  BD 06 1E              LDA FT_GAMEOVER,X
00672  09AF  9D 00 04              STA $0400,X+#0
00673  09B2  E8                    INX
00674  09B3  E0 8B                 CPX #$8B
00675  09B5  D0 EE                 BNE @LOOP
00676  09B7             @GAMEOVERLOOP 
00677  09B7  20 EB 0A              JSR READJOYSTICK
00678  09BA  A5 02                 LDA JOYSTICK_INPUT
00679  09BC  2D 4A 2A              AND PLAYER_UP
00680  09BF  D0 04                 BNE @GOTOTITLE
00681  09C1  4C B7 09              JMP @GAMEOVERLOOP
00682  09C4  60                    RTS
00683  09C5             @GOTOTITLE 
00684  09C5  A2 00                 LDX COLOUR_BLACK
00685  09C7  8E 21 D0              STX BG_COLOUR
00686  09CA  A2 0E                 LDX COLOUR_LIGHT_BLUE
00687  09CC  8E 86 02              STX TEXT_COLOUR
00688  09CF             
00689  09CF             
00690  09CF  A9 00                 LDA #%00000000
00691  09D1  8D 15 D0              STA SPRITE_ENABLED
00692  09D4                        
00693  09D4  20 E5 0A              JSR CLEARSCREEN
00694  09D7  20 6D 0E              JSR DRAWTITLE
00695  09DA  A2 05                 LDX #5
00696  09DC  8E 01 70              STX PLAYER_LIVES
00697  09DF  A2 00                 LDX #0
00698  09E1  8E 00 70              STX PLAYER_DYING_COUNTER
00699  09E4  4C 47 08              JMP TITLELOOP
00700  09E7             NEXTLEVEL
00701  09E7  20 E5 0A              JSR CLEARSCREEN
00702  09EA             
00703  09EA             
00704  09EA  A9 00                 LDA #%00000000
00705  09EC  8D 15 D0              STA SPRITE_ENABLED
00706  09EF                        
00707  09EF  A9 01                 LDA COLOUR_WHITE
00708  09F1  8D 86 02              STA TEXT_COLOUR
00709  09F4             
00710  09F4             
00711  09F4  AD 16 D0              LDA SCREEN_CONTROL
00712  09F7  29 EF                 AND #$EF
00713  09F9  8D 16 D0              STA SCREEN_CONTROL
00714  09FC             
00715  09FC             
00716  09FC  AD 18 D0              LDA CHARSET_LOOKUP
00717  09FF  29 F8                 AND #%11111000
00718  0A01  09 05                 ORA #%00000101
00719  0A03  8D 18 D0              STA CHARSET_LOOKUP
00720  0A06  20 A9 0E              JSR DRAWFOREVER
00721  0A09             
00722  0A09             
00723  0A09  A2 00                 LDX #0
00724  0A0B  A0 00                 LDY #0
00725  0A0D             @LOOP
00726  0A0D  A9 FF                 LDA #255
00727  0A0F  CD 12 D0              CMP RASTER_LINE
00728  0A12  D0 F9                 BNE @LOOP
00729  0A14  BD DC 13              LDA FT_LEVEL1,X
00730  0A17  9D 50 04              STA $0400,X+#$50
00731  0A1A  E8                    INX
00732  0A1B  E0 8E                 CPX #142
00733  0A1D  D0 EE                 BNE @LOOP
00734  0A1F             NEXTLEVELLOOP 
00735  0A1F             
00736  0A1F             
00737  0A1F             @RASTERLOOP 
00738  0A1F  A9 FA                 LDA #250
00739  0A21  CD 12 D0              CMP RASTER_LINE
00740  0A24  D0 F9                 BNE @RASTERLOOP
00741  0A26             
00742  0A26             
00743  0A26  AD 18 D0              LDA CHARSET_LOOKUP
00744  0A29  29 F8                 AND #%11111000
00745  0A2B  09 07                 ORA #%000000111
00746  0A2D  8D 18 D0              STA CHARSET_LOOKUP
00747  0A30                        
00748  0A30             
00749  0A30             
00750  0A30             @RASTERLOOP 
00751  0A30  A9 81                 LDA #129
00752  0A32  CD 12 D0              CMP RASTER_LINE
00753  0A35  D0 F9                 BNE @RASTERLOOP
00754  0A37             
00755  0A37             
00756  0A37  AD 18 D0              LDA CHARSET_LOOKUP
00757  0A3A  29 F8                 AND #%11111000
00758  0A3C  09 05                 ORA #%000000101
00759  0A3E  8D 18 D0              STA CHARSET_LOOKUP
00760  0A41                        
00761  0A41  AE 01 70              LDX PLAYER_LIVES
00762  0A44  20 EB 0A              JSR READJOYSTICK
00763  0A47  A5 02                 LDA JOYSTICK_INPUT
00764  0A49  29 01                 AND PLAYER_ACTION
00765  0A4B  D0 03                 BNE INITNEWLEVEL
00766  0A4D  4C 1F 0A              JMP NEXTLEVELLOOP
00767  0A50             INITNEWLEVEL 
00768  0A50  20 E5 0A              JSR CLEARSCREEN
00769  0A53             
00770  0A53             
00771  0A53  AD 18 D0              LDA CHARSET_LOOKUP
00772  0A56  29 F8                 AND #%11111000
00773  0A58  09 07                 ORA #%00000111
00774  0A5A  8D 18 D0              STA CHARSET_LOOKUP
00775  0A5D             
00776  0A5D             
00777  0A5D  AD 16 D0              LDA SCREEN_CONTROL
00778  0A60  09 10                 ORA #$10
00779  0A62  8D 16 D0              STA SCREEN_CONTROL
00780  0A65             
00781  0A65             
00782  0A65  A9 0E                 LDA COLOUR_LIGHT_BLUE
00783  0A67  8D 86 02              STA TEXT_COLOUR
00784  0A6A             
00785  0A6A             
00786  0A6A  A9 00                 LDA COLOUR_BLACK
00787  0A6C  8D 21 D0              STA BG_COLOUR
00788  0A6F  A9 0E                 LDA COLOUR_LIGHT_BLUE
00789  0A71  8D 22 D0              STA BG_COLOUR1
00790  0A74  A9 01                 LDA COLOUR_WHITE
00791  0A76  8D 23 D0              STA BG_COLOUR2
00792  0A79  A9 02                 LDA COLOUR_RED
00793  0A7B  8D 24 D0              STA BG_COLOUR3
00794  0A7E  20 31 0E              JSR DRAWLEVEL
00795  0A81  20 4B 0D              JSR INITSPRITES
00796  0A84             @EXIT
00797  0A84  60                    RTS
00798  0A85             HANDLEDOOR2OPEN 
00799  0A85  AD 08 70              LDA DOOR2_OPEN_COUNTER
00800  0A88  AA                    TAX
00801  0A89  E8                    INX
00802  0A8A  8E 08 70              STX DOOR2_OPEN_COUNTER
00803  0A8D  C9 01                 CMP #1
00804  0A8F  F0 14                 BEQ @DOOR2OPENFRAME1
00805  0A91  C9 02                 CMP #2
00806  0A93  F0 1C                 BEQ @DOOR2OPENFRAME2
00807  0A95  C9 03                 CMP #3
00808  0A97  F0 24                 BEQ @DOOR2OPENFRAME3
00809  0A99  C9 04                 CMP #4
00810  0A9B  F0 2C                 BEQ @DOOR2OPENFRAME4
00811  0A9D  C9 05                 CMP #5
00812  0A9F  F0 34                 BEQ DESTROYDOOR2
00813  0AA1  4C 66 08              JMP GAMELOOP
00814  0AA4  60                    RTS
00815  0AA5             @DOOR2OPENFRAME1 
00816  0AA5  AD 64 2A              LDA HORI_DOOR_FRAME2
00817  0AA8  8D 60 2A              STA HORI_DOOR_SPRITE_INDEX
00818  0AAB  20 F7 0D              JSR UPDATEHORIDOORSPRITE
00819  0AAE  4C 66 08              JMP GAMELOOP
00820  0AB1             @DOOR2OPENFRAME2 
00821  0AB1  AD 65 2A              LDA HORI_DOOR_FRAME3
00822  0AB4  8D 60 2A              STA HORI_DOOR_SPRITE_INDEX
00823  0AB7  20 F7 0D              JSR UPDATEHORIDOORSPRITE
00824  0ABA  4C 66 08              JMP GAMELOOP
00825  0ABD             @DOOR2OPENFRAME3 
00826  0ABD  AD 66 2A              LDA HORI_DOOR_FRAME4
00827  0AC0  8D 60 2A              STA HORI_DOOR_SPRITE_INDEX
00828  0AC3  20 F7 0D              JSR UPDATEHORIDOORSPRITE
00829  0AC6  4C 66 08              JMP GAMELOOP
00830  0AC9             @DOOR2OPENFRAME4 
00831  0AC9  AD 5F 2A              LDA DOOR_FRAME5
00832  0ACC  8D 60 2A              STA HORI_DOOR_SPRITE_INDEX
00833  0ACF  20 F0 0D              JSR UPDATEDOORSPRITE
00834  0AD2  4C 66 08              JMP GAMELOOP
00835  0AD5             DESTROYDOOR2 
00836  0AD5             
00837  0AD5             
00838  0AD5  AD 15 D0              LDA SPRITE_ENABLED
00839  0AD8  29 F7                 AND #%11110111
00840  0ADA  8D 15 D0              STA SPRITE_ENABLED
00841  0ADD  A2 00                 LDX #0
00842  0ADF  8E 08 70              STX DOOR2_OPEN_COUNTER
00843  0AE2  4C 66 08              JMP GAMELOOP
00844  0AE5             
00845  0AE5             
00846  0AE5             
00847  0AE5             CLEARSCREEN 
00848  0AE5  A9 93                 LDA #147
00849  0AE7  20 D2 FF              JSR CHAROUT
00850  0AEA  60                    RTS
00851  0AEB             
00852  0AEB             
00853  0AEB             READJOYSTICK 
00854  0AEB  A0 00                 LDY #0
00855  0AED  84 02                 STY JOYSTICK_INPUT
00856  0AEF  20 FF 0A              JSR @CHECKRIGHT
00857  0AF2  20 0E 0B              JSR @CHECKLEFT
00858  0AF5  20 1D 0B              JSR @CHECKUP
00859  0AF8  20 2C 0B              JSR @CHECKDOWN
00860  0AFB  20 34 0B              JSR @CHECKBTN
00861  0AFE  60                    RTS
00862  0AFF             @CHECKRIGHT 
00863  0AFF  AD 00 DC              LDA JOYSTICK_PORT2
00864  0B02  29 08                 AND #JOYSTICK_MASK_RIGHT
00865  0B04  F0 01                 BEQ @INPUTRIGHT
00866  0B06  60                    RTS
00867  0B07             @INPUTRIGHT 
00868  0B07  A5 02                 LDA JOYSTICK_INPUT
00869  0B09  09 04                 ORA #4
00870  0B0B  85 02                 STA JOYSTICK_INPUT
00871  0B0D  60                    RTS
00872  0B0E             @CHECKLEFT 
00873  0B0E  AD 00 DC              LDA JOYSTICK_PORT2
00874  0B11  29 04                 AND #JOYSTICK_MASK_LEFT
00875  0B13  F0 01                 BEQ @INPUTLEFT
00876  0B15  60                    RTS
00877  0B16             @INPUTLEFT 
00878  0B16  A5 02                 LDA JOYSTICK_INPUT
00879  0B18  09 10                 ORA #16
00880  0B1A  85 02                 STA JOYSTICK_INPUT
00881  0B1C  60                    RTS
00882  0B1D             @CHECKUP
00883  0B1D  AD 00 DC              LDA JOYSTICK_PORT2
00884  0B20  29 01                 AND #JOYSTICK_MASK_UP
00885  0B22  F0 01                 BEQ @INPUTUP
00886  0B24  60                    RTS
00887  0B25             @INPUTUP
00888  0B25  A5 02                 LDA JOYSTICK_INPUT
00889  0B27  09 02                 ORA #2
00890  0B29  85 02                 STA JOYSTICK_INPUT
00891  0B2B  60                    RTS
00892  0B2C             @CHECKDOWN 
00893  0B2C  AD 00 DC              LDA JOYSTICK_PORT2
00894  0B2F  29 02                 AND #JOYSTICK_MASK_DOWN
00895  0B31  F0 09                 BEQ @INPUTDOWN
00896  0B33  60                    RTS
00897  0B34             @CHECKBTN
00898  0B34  AD 00 DC              LDA JOYSTICK_PORT2
00899  0B37  29 10                 AND #JOYSTICK_MASK_BTN
00900  0B39  F0 08                 BEQ @INPUTBTN
00901  0B3B  60                    RTS
00902  0B3C             @INPUTDOWN 
00903  0B3C  A5 02                 LDA JOYSTICK_INPUT
00904  0B3E  09 08                 ORA #8
00905  0B40  85 02                 STA JOYSTICK_INPUT
00906  0B42  60                    RTS
00907  0B43             @INPUTBTN
00908  0B43  A5 02                 LDA JOYSTICK_INPUT
00909  0B45  09 01                 ORA #1
00910  0B47  85 02                 STA JOYSTICK_INPUT
00911  0B49  60                    RTS
00912  0B4A             
00913  0B4A             READJOYSTICK1 
00914  0B4A  A0 00                 LDY #0
00915  0B4C  84 02                 STY JOYSTICK_INPUT1
00916  0B4E  20 5E 0B              JSR @CHECKRIGHT
00917  0B51  20 6D 0B              JSR @CHECKLEFT
00918  0B54  20 7C 0B              JSR @CHECKUP
00919  0B57  20 8B 0B              JSR @CHECKDOWN
00920  0B5A  20 93 0B              JSR @CHECKBTN
00921  0B5D  60                    RTS
00922  0B5E             @CHECKRIGHT 
00923  0B5E  AD 01 DC              LDA JOYSTICK_PORT1
00924  0B61  29 08                 AND #JOYSTICK_MASK_RIGHT
00925  0B63  F0 01                 BEQ @INPUTRIGHT
00926  0B65  60                    RTS
00927  0B66             @INPUTRIGHT 
00928  0B66  A5 02                 LDA JOYSTICK_INPUT1
00929  0B68  09 04                 ORA #4
00930  0B6A  85 02                 STA JOYSTICK_INPUT1
00931  0B6C  60                    RTS
00932  0B6D             @CHECKLEFT 
00933  0B6D  AD 01 DC              LDA JOYSTICK_PORT1
00934  0B70  29 04                 AND #JOYSTICK_MASK_LEFT
00935  0B72  F0 01                 BEQ @INPUTLEFT
00936  0B74  60                    RTS
00937  0B75             @INPUTLEFT 
00938  0B75  A5 02                 LDA JOYSTICK_INPUT1
00939  0B77  09 10                 ORA #16
00940  0B79  85 02                 STA JOYSTICK_INPUT1
00941  0B7B  60                    RTS
00942  0B7C             @CHECKUP
00943  0B7C  AD 01 DC              LDA JOYSTICK_PORT1
00944  0B7F  29 01                 AND #JOYSTICK_MASK_UP
00945  0B81  F0 01                 BEQ @INPUTUP
00946  0B83  60                    RTS
00947  0B84             @INPUTUP
00948  0B84  A5 02                 LDA JOYSTICK_INPUT1
00949  0B86  09 02                 ORA #2
00950  0B88  85 02                 STA JOYSTICK_INPUT1
00951  0B8A  60                    RTS
00952  0B8B             @CHECKDOWN 
00953  0B8B  AD 01 DC              LDA JOYSTICK_PORT1
00954  0B8E  29 02                 AND #JOYSTICK_MASK_DOWN
00955  0B90  F0 09                 BEQ @INPUTDOWN
00956  0B92  60                    RTS
00957  0B93             @CHECKBTN
00958  0B93  AD 01 DC              LDA JOYSTICK_PORT1
00959  0B96  29 10                 AND #JOYSTICK_MASK_BTN
00960  0B98  F0 08                 BEQ @INPUTBTN
00961  0B9A  60                    RTS
00962  0B9B             @INPUTDOWN 
00963  0B9B  A5 02                 LDA JOYSTICK_INPUT1
00964  0B9D  09 08                 ORA #8
00965  0B9F  85 02                 STA JOYSTICK_INPUT1
00966  0BA1  60                    RTS
00967  0BA2             @INPUTBTN
00968  0BA2  A5 02                 LDA JOYSTICK_INPUT1
00969  0BA4  09 01                 ORA #1
00970  0BA6  85 02                 STA JOYSTICK_INPUT1
00971  0BA8  60                    RTS
00972  0BA9             
00973  0BA9             
00974  0BA9             
00975  0BA9             MOVEPLAYER 
00976  0BA9  20 EB 0A              JSR READJOYSTICK
00977  0BAC  20 B9 0B              JSR @CHECKUP
00978  0BAF  20 19 0C              JSR @CHECKDOWN
00979  0BB2  20 2F 0C              JSR @CHECKLEFT
00980  0BB5  20 CF 0B              JSR @CHECKRIGHT
00981  0BB8  60                    RTS
00982  0BB9             @CHECKUP
00983  0BB9  A5 02                 LDA JOYSTICK_INPUT
00984  0BBB  29 02                 AND PLAYER_MOVED_UP
00985  0BBD  F0 41                 BEQ @CONTINUE
00986  0BBF  AC 46 2A              LDY PLAYER_Y
00987  0BC2  88                    DEY
00988  0BC3  8C 46 2A              STY PLAYER_Y
00989  0BC6  A0 01                 LDY #$1
00990  0BC8  8C 02 70              STY PLAYER_MOVED_THIS_FRAME
00991  0BCB  20 78 0F              JSR PLAYFOOTSTEP
00992  0BCE  60                    RTS
00993  0BCF             @CHECKRIGHT 
00994  0BCF  A5 02                 LDA JOYSTICK_INPUT
00995  0BD1  29 04                 AND PLAYER_MOVED_RIGHT
00996  0BD3  F0 2B                 BEQ @CONTINUE
00997  0BD5  AE 45 2A              LDX PLAYER_X
00998  0BD8  E8                    INX
00999  0BD9  8E 45 2A              STX PLAYER_X
01000  0BDC  A0 01                 LDY #$1
01001  0BDE  8C 02 70              STY PLAYER_MOVED_THIS_FRAME
01002  0BE1  20 78 0F              JSR PLAYFOOTSTEP
01003  0BE4                        ;RIGHT SIDE WRAP
01004  0BE4  AD 10 D0              LDA SPRITE_OVERFLOW
01005  0BE7  29 01                 AND #%00000001
01006  0BE9  D0 16                 BNE @CHECKWRAP
01007  0BEB  AE 45 2A              LDX PLAYER_X
01008  0BEE  E0 FF                 CPX #255
01009  0BF0  D0 0E                 BNE @CONTINUE
01010  0BF2  AD 10 D0              LDA SPRITE_OVERFLOW
01011  0BF5  09 01                 ORA #%00000001
01012  0BF7  8D 10 D0              STA SPRITE_OVERFLOW
01013  0BFA  A2 00                 LDX #0
01014  0BFC  8E 45 2A              STX PLAYER_X
01015  0BFF  60                    RTS
01016  0C00             @CONTINUE
01017  0C00  60                    RTS
01018  0C01             @CHECKWRAP 
01019  0C01  AE 45 2A              LDX PLAYER_X
01020  0C04  E0 30                 CPX #48
01021  0C06  D0 F8                 BNE @CONTINUE
01022  0C08  A2 00                 LDX #0
01023  0C0A  8E 45 2A              STX PLAYER_X
01024  0C0D  AD 10 D0              LDA SPRITE_OVERFLOW
01025  0C10  29 FE                 AND #%11111110
01026  0C12  8D 10 D0              STA SPRITE_OVERFLOW
01027  0C15  20 E7 09              JSR NEXTLEVEL
01028  0C18  60                    RTS
01029  0C19             @CHECKDOWN 
01030  0C19  A5 02                 LDA JOYSTICK_INPUT
01031  0C1B  29 08                 AND PLAYER_MOVED_DOWN
01032  0C1D  F0 E1                 BEQ @CONTINUE
01033  0C1F  AC 46 2A              LDY PLAYER_Y
01034  0C22  C8                    INY
01035  0C23  8C 46 2A              STY PLAYER_Y
01036  0C26  A0 01                 LDY #$1
01037  0C28  8C 02 70              STY PLAYER_MOVED_THIS_FRAME
01038  0C2B  20 78 0F              JSR PLAYFOOTSTEP
01039  0C2E  60                    RTS
01040  0C2F             @CHECKLEFT 
01041  0C2F  A5 02                 LDA JOYSTICK_INPUT
01042  0C31  29 10                 AND PLAYER_MOVED_LEFT
01043  0C33  F0 CB                 BEQ @CONTINUE
01044  0C35  AE 45 2A              LDX PLAYER_X
01045  0C38  CA                    DEX
01046  0C39  8E 45 2A              STX PLAYER_X
01047  0C3C  A0 01                 LDY #$1
01048  0C3E  8C 02 70              STY PLAYER_MOVED_THIS_FRAME
01049  0C41  20 78 0F              JSR PLAYFOOTSTEP
01050  0C44                        ; LEFT SIDE WRAP
01051  0C44  AD 10 D0              LDA SPRITE_OVERFLOW
01052  0C47  29 01                 AND #%00000001
01053  0C49  D0 18                 BNE @CHECKLEFTWRAP
01054  0C4B  AD 10 D0              LDA SPRITE_OVERFLOW
01055  0C4E  AE 45 2A              LDX PLAYER_X
01056  0C51  E0 00                 CPX #0
01057  0C53  D0 AB                 BNE @CONTINUE
01058  0C55  AD 10 D0              LDA SPRITE_OVERFLOW
01059  0C58  09 01                 ORA #%00000001
01060  0C5A  8D 10 D0              STA SPRITE_OVERFLOW
01061  0C5D  A9 50                 LDA #80
01062  0C5F  8D 45 2A              STA PLAYER_X
01063  0C62  60                    RTS
01064  0C63             @CHECKLEFTWRAP 
01065  0C63  AE 45 2A              LDX PLAYER_X
01066  0C66  E0 00                 CPX #0
01067  0C68  D0 96                 BNE @CONTINUE
01068  0C6A  AD 10 D0              LDA SPRITE_OVERFLOW
01069  0C6D  29 FE                 AND #%11111110
01070  0C6F  8D 10 D0              STA SPRITE_OVERFLOW
01071  0C72  A2 FF                 LDX #255
01072  0C74  8E 45 2A              STX PLAYER_X
01073  0C77  60                    RTS
01074  0C78             
01075  0C78             
01076  0C78             
01077  0C78             UPDATEPLAYERANIMATIONFRAME 
01078  0C78  A5 02                 LDA JOYSTICK_INPUT
01079  0C7A  29 04                 AND PLAYER_MOVED_RIGHT
01080  0C7C  D0 19                 BNE @SETRIGHT
01081  0C7E  A5 02                 LDA JOYSTICK_INPUT
01082  0C80  29 10                 AND PLAYER_MOVED_LEFT
01083  0C82  D0 26                 BNE @SETLEFT
01084  0C84  A5 02                 LDA JOYSTICK_INPUT
01085  0C86  29 02                 AND PLAYER_MOVED_UP
01086  0C88  D0 33                 BNE @SETUP
01087  0C8A  A5 02                 LDA JOYSTICK_INPUT
01088  0C8C  29 08                 AND PLAYER_MOVED_DOWN
01089  0C8E  D0 40                 BNE @SETDOWN
01090  0C90  AE 47 2A              LDX PLAYER_IDLE
01091  0C93  8E 44 2A              STX PLAYER_SPRITE_INDEX
01092  0C96  60                    RTS
01093  0C97             @SETRIGHT
01094  0C97  AE 44 2A              LDX PLAYER_SPRITE_INDEX
01095  0C9A  E0 82                 CPX PLAYER_RIGHT_ANIM2
01096  0C9C  F0 06                 BEQ @RIGHTFRAME1
01097  0C9E  A2 82                 LDX PLAYER_RIGHT_ANIM2
01098  0CA0  8E 44 2A              STX PLAYER_SPRITE_INDEX
01099  0CA3  60                    RTS
01100  0CA4             @RIGHTFRAME1 
01101  0CA4  A2 81                 LDX PLAYER_RIGHT_ANIM1
01102  0CA6  8E 44 2A              STX PLAYER_SPRITE_INDEX
01103  0CA9  60                    RTS
01104  0CAA             @SETLEFT
01105  0CAA  AE 44 2A              LDX PLAYER_SPRITE_INDEX
01106  0CAD  E0 84                 CPX PLAYER_LEFT_ANIM2
01107  0CAF  F0 06                 BEQ @LEFTFRAME1
01108  0CB1  A2 84                 LDX PLAYER_LEFT_ANIM2
01109  0CB3  8E 44 2A              STX PLAYER_SPRITE_INDEX
01110  0CB6  60                    RTS
01111  0CB7             @LEFTFRAME1 
01112  0CB7  A2 83                 LDX PLAYER_LEFT_ANIM1
01113  0CB9  8E 44 2A              STX PLAYER_SPRITE_INDEX
01114  0CBC  60                    RTS
01115  0CBD             @SETUP
01116  0CBD  AE 44 2A              LDX PLAYER_SPRITE_INDEX
01117  0CC0  E0 86                 CPX PLAYER_UP_ANIM2
01118  0CC2  F0 06                 BEQ @UPFRAME1
01119  0CC4  A2 86                 LDX PLAYER_UP_ANIM2
01120  0CC6  8E 44 2A              STX PLAYER_SPRITE_INDEX
01121  0CC9  60                    RTS
01122  0CCA             @UPFRAME1
01123  0CCA  A2 85                 LDX PLAYER_UP_ANIM1
01124  0CCC  8E 44 2A              STX PLAYER_SPRITE_INDEX
01125  0CCF  60                    RTS
01126  0CD0             @SETDOWN
01127  0CD0  AE 44 2A              LDX PLAYER_SPRITE_INDEX
01128  0CD3  E0 88                 CPX PLAYER_DOWN_ANIM2
01129  0CD5  F0 06                 BEQ @DOWNFRAME1
01130  0CD7  A2 88                 LDX PLAYER_DOWN_ANIM2
01131  0CD9  8E 44 2A              STX PLAYER_SPRITE_INDEX
01132  0CDC  60                    RTS
01133  0CDD             @DOWNFRAME1 
01134  0CDD  A2 87                 LDX PLAYER_DOWN_ANIM1
01135  0CDF  8E 44 2A              STX PLAYER_SPRITE_INDEX
01136  0CE2  60                    RTS
01137  0CE3             
01138  0CE3             
01139  0CE3             UPDATEPLAYERSPRITEPOSITION 
01140  0CE3  AD 45 2A              LDA PLAYER_X
01141  0CE6  8D 00 D0              STA SPRITE0_X
01142  0CE9  AD 46 2A              LDA PLAYER_Y
01143  0CEC  8D 01 D0              STA SPRITE0_Y
01144  0CEF  60                    RTS
01145  0CF0             
01146  0CF0             UPDATEPLAYERBULLETPOSITION 
01147  0CF0  AD 4D 2A              LDA PLAYER_BULLET_X
01148  0CF3  8D 02 D0              STA SPRITE1_X
01149  0CF6  AD 4E 2A              LDA PLAYER_BULLET_Y
01150  0CF9  8D 03 D0              STA SPRITE1_Y
01151  0CFC  60                    RTS
01152  0CFD             
01153  0CFD             UPDATEDOORPOSITION 
01154  0CFD  AD 59 2A              LDA DOOR_X
01155  0D00  8D 04 D0              STA SPRITE2_X
01156  0D03  AD 5A 2A              LDA DOOR_Y
01157  0D06  8D 05 D0              STA SPRITE2_Y
01158  0D09  60                    RTS
01159  0D0A             
01160  0D0A             UPDATEHORIDOORPOSITION 
01161  0D0A  AD 61 2A              LDA HORI_DOOR_X
01162  0D0D  8D 06 D0              STA SPRITE3_X
01163  0D10  AD 62 2A              LDA HORI_DOOR_Y
01164  0D13  8D 07 D0              STA SPRITE3_Y
01165  0D16  60                    RTS
01166  0D17             
01167  0D17             UPDATEBUTTONPOSITION 
01168  0D17  AD 69 2A              LDA BUTTON_X
01169  0D1A  8D 08 D0              STA SPRITE4_X
01170  0D1D  AD 6A 2A              LDA BUTTON_Y
01171  0D20  8D 09 D0              STA SPRITE4_Y
01172  0D23  60                    RTS
01173  0D24             
01174  0D24             UPDATEBUTTON2POSITION 
01175  0D24  AD 6F 2A              LDA BUTTON2_X
01176  0D27  8D 0A D0              STA SPRITE5_X
01177  0D2A  AD 70 2A              LDA BUTTON2_Y
01178  0D2D  8D 0B D0              STA SPRITE5_Y
01179  0D30  60                    RTS
01180  0D31             
01181  0D31             UPDATENPC1POSITION 
01182  0D31  AD 76 2A              LDA NPC1_X
01183  0D34  8D 0C D0              STA SPRITE6_X
01184  0D37  AD 77 2A              LDA NPC1_Y
01185  0D3A  8D 0D D0              STA SPRITE6_Y
01186  0D3D  60                    RTS
01187  0D3E             
01188  0D3E             UPDATENPC2POSITION 
01189  0D3E  AD 78 2A              LDA NPC2_X
01190  0D41  8D 0E D0              STA SPRITE7_X
01191  0D44  AD 79 2A              LDA NPC2_Y
01192  0D47  8D 0F D0              STA SPRITE7_Y
01193  0D4A  60                    RTS
01194  0D4B             
01195  0D4B             INITSPRITES 
01196  0D4B             
01197  0D4B             
01198  0D4B  A9 FD                 LDA #%11111101
01199  0D4D  8D 15 D0              STA SPRITE_ENABLED
01200  0D50                        
01201  0D50  AD 47 2A              LDA PLAYER_IDLE
01202  0D53  8D 44 2A              STA PLAYER_SPRITE_INDEX
01203  0D56  8D 74 2A              STA NPC1_SPRITE_INDEX
01204  0D59  8D 75 2A              STA NPC2_SPRITE_INDEX
01205  0D5C  AD 4F 2A              LDA PLAYER_BULLET_HORI
01206  0D5F  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01207  0D62  AD 5B 2A              LDA DOOR_FRAME1
01208  0D65  8D 58 2A              STA DOOR_SPRITE_INDEX
01209  0D68  AD 63 2A              LDA HORI_DOOR_FRAME1
01210  0D6B  8D 60 2A              STA HORI_DOOR_SPRITE_INDEX
01211  0D6E                        
01212  0D6E  AD 6B 2A              LDA BUTTON_FRAME1
01213  0D71  8D 68 2A              STA BUTTON_SPRITE_INDEX
01214  0D74  8D 6E 2A              STA BUTTON2_SPRITE_INDEX
01215  0D77             
01216  0D77             
01217  0D77  AD 44 2A              LDA PLAYER_SPRITE_INDEX
01218  0D7A  8D F8 07              STA SPRITE0_POINTER
01219  0D7D             
01220  0D7D             
01221  0D7D  AD 4C 2A              LDA PLAYER_BULLET_SPRITE_INDEX
01222  0D80  8D F9 07              STA SPRITE1_POINTER
01223  0D83             
01224  0D83             
01225  0D83  AD 58 2A              LDA DOOR_SPRITE_INDEX
01226  0D86  8D FA 07              STA SPRITE2_POINTER
01227  0D89             
01228  0D89             
01229  0D89  AD 60 2A              LDA HORI_DOOR_SPRITE_INDEX
01230  0D8C  8D FB 07              STA SPRITE3_POINTER
01231  0D8F             
01232  0D8F             
01233  0D8F  AD 68 2A              LDA BUTTON_SPRITE_INDEX
01234  0D92  8D FC 07              STA SPRITE4_POINTER
01235  0D95             
01236  0D95             
01237  0D95  AD 6E 2A              LDA BUTTON2_SPRITE_INDEX
01238  0D98  8D FD 07              STA SPRITE5_POINTER
01239  0D9B             
01240  0D9B             
01241  0D9B  AD 74 2A              LDA NPC1_SPRITE_INDEX
01242  0D9E  8D FE 07              STA SPRITE6_POINTER
01243  0DA1             
01244  0DA1             
01245  0DA1  AD 75 2A              LDA NPC2_SPRITE_INDEX
01246  0DA4  8D FF 07              STA SPRITE7_POINTER
01247  0DA7  AD 10 D0              LDA SPRITE_OVERFLOW
01248  0DAA  09 A8                 ORA #%10101000
01249  0DAC  8D 10 D0              STA SPRITE_OVERFLOW
01250  0DAF  A9 0E                 LDA COLOUR_LIGHT_BLUE
01251  0DB1  8D 27 D0              STA SPRITE0_COLOUR
01252  0DB4  A9 02                 LDA COLOUR_RED
01253  0DB6  8D 28 D0              STA SPRITE1_COLOUR
01254  0DB9  A2 4A                 LDX #$4A
01255  0DBB  8E 45 2A              STX PLAYER_X
01256  0DBE  8E 4D 2A              STX PLAYER_BULLET_X
01257  0DC1  A0 5E                 LDY #$5E
01258  0DC3  8C 46 2A              STY PLAYER_Y
01259  0DC6  8E 4E 2A              STX PLAYER_BULLET_Y
01260  0DC9  20 E3 0C              JSR UPDATEPLAYERSPRITEPOSITION
01261  0DCC  20 F0 0C              JSR UPDATEPLAYERBULLETPOSITION
01262  0DCF  20 0A 0D              JSR UPDATEHORIDOORPOSITION
01263  0DD2  20 FD 0C              JSR UPDATEDOORPOSITION
01264  0DD5  20 17 0D              JSR UPDATEBUTTONPOSITION
01265  0DD8  20 24 0D              JSR UPDATEBUTTON2POSITION
01266  0DDB  20 31 0D              JSR UPDATENPC1POSITION
01267  0DDE  20 3E 0D              JSR UPDATENPC2POSITION
01268  0DE1  60                    RTS
01269  0DE2             
01270  0DE2             UPDATEPLAYERSPRITE 
01271  0DE2             
01272  0DE2             
01273  0DE2  AD 44 2A              LDA PLAYER_SPRITE_INDEX
01274  0DE5  8D F8 07              STA SPRITE0_POINTER
01275  0DE8  60                    RTS
01276  0DE9             
01277  0DE9             UPDATEPLAYERBULLETSPRITE 
01278  0DE9             
01279  0DE9             
01280  0DE9  AD 4C 2A              LDA PLAYER_BULLET_SPRITE_INDEX
01281  0DEC  8D F9 07              STA SPRITE1_POINTER
01282  0DEF  60                    RTS
01283  0DF0             
01284  0DF0             UPDATEDOORSPRITE 
01285  0DF0             
01286  0DF0             
01287  0DF0  AD 58 2A              LDA DOOR_SPRITE_INDEX
01288  0DF3  8D FA 07              STA SPRITE2_POINTER
01289  0DF6  60                    RTS
01290  0DF7             
01291  0DF7             UPDATEHORIDOORSPRITE 
01292  0DF7             
01293  0DF7             
01294  0DF7  AD 60 2A              LDA HORI_DOOR_SPRITE_INDEX
01295  0DFA  8D FB 07              STA SPRITE3_POINTER
01296  0DFD  60                    RTS
01297  0DFE             
01298  0DFE             UPDATEBUTTONSPRITE 
01299  0DFE             
01300  0DFE             
01301  0DFE  AD 68 2A              LDA BUTTON_SPRITE_INDEX
01302  0E01  8D FC 07              STA SPRITE4_POINTER
01303  0E04  60                    RTS
01304  0E05             
01305  0E05             UPDATEBUTTON2SPRITE 
01306  0E05             
01307  0E05             
01308  0E05  AD 6E 2A              LDA BUTTON2_SPRITE_INDEX
01309  0E08  8D FD 07              STA SPRITE5_POINTER
01310  0E0B  60                    RTS
01311  0E0C             
01312  0E0C             INITCHARACTERSET 
01313  0E0C  AD 18 D0              LDA CHARSET_LOOKUP
01314  0E0F  09 0E                 ORA #$0E
01315  0E11  8D 18 D0              STA CHARSET_LOOKUP
01316  0E14  AD 16 D0              LDA SCREEN_CONTROL
01317  0E17  09 10                 ORA #%00010000
01318  0E19  8D 16 D0              STA SCREEN_CONTROL
01319  0E1C                        ;LDA COLOUR_LIGHT_BLUE
01320  0E1C                        ;STA BG_COLOUR1
01321  0E1C                        ;LDA COLOUR_WHITE
01322  0E1C                        ;STA BG_COLOUR2
01323  0E1C                        ;LDA COLOUR_RED
01324  0E1C                        ;STA BG_COLOUR3
01325  0E1C             
01326  0E1C             
01327  0E1C  A9 00                 LDA COLOUR_BLACK
01328  0E1E  8D 21 D0              STA BG_COLOUR
01329  0E21  A9 0E                 LDA COLOUR_LIGHT_BLUE
01330  0E23  8D 22 D0              STA BG_COLOUR1
01331  0E26  A9 01                 LDA COLOUR_WHITE
01332  0E28  8D 23 D0              STA BG_COLOUR2
01333  0E2B  A9 02                 LDA COLOUR_RED
01334  0E2D  8D 24 D0              STA BG_COLOUR3
01335  0E30  60                    RTS
01336  0E31             
01337  0E31             DRAWLEVEL
01338  0E31             
01339  0E31             
01340  0E31  A2 00                 LDX #0
01341  0E33             @BLOCK1
01342  0E33  BD 00 50              LDA LEVEL1_BLOCK1,X
01343  0E36  A8                    TAY
01344  0E37  9D 00 04              STA SCREEN_BLOCK1,X
01345  0E3A  E8                    INX
01346  0E3B  E0 FF                 CPX #255
01347  0E3D  D0 F4                 BNE @BLOCK1
01348  0E3F  A2 00                 LDX #0
01349  0E41             @BLOCK2
01350  0E41  BD FF 50              LDA LEVEL1_BLOCK2,X
01351  0E44  A8                    TAY
01352  0E45  9D FF 04              STA SCREEN_BLOCK2,X
01353  0E48  E8                    INX
01354  0E49  E0 FF                 CPX #255
01355  0E4B  D0 F4                 BNE @BLOCK2
01356  0E4D  A2 00                 LDX #0
01357  0E4F             @BLOCK3
01358  0E4F  BD FE 51              LDA LEVEL1_BLOCK3,X
01359  0E52  A8                    TAY
01360  0E53  9D FE 05              STA SCREEN_BLOCK3,X
01361  0E56  E8                    INX
01362  0E57  E0 FF                 CPX #255
01363  0E59  D0 F4                 BNE @BLOCK3
01364  0E5B  A2 00                 LDX #0
01365  0E5D             @BLOCK4
01366  0E5D  BD FD 52              LDA LEVEL1_BLOCK4,X
01367  0E60  A8                    TAY
01368  0E61  9D FD 06              STA SCREEN_BLOCK4,X
01369  0E64  E8                    INX
01370  0E65  E0 FF                 CPX #255
01371  0E67  D0 F4                 BNE @BLOCK4
01372  0E69  A2 00                 LDX #0
01373  0E6B  60                    RTS
01374  0E6C  60                    RTS
01375  0E6D             
01376  0E6D             DRAWTITLE
01377  0E6D             
01378  0E6D             
01379  0E6D  A2 00                 LDX #0
01380  0E6F             @BLOCK1
01381  0E6F  BD 00 54              LDA TITLE_BLOCK1,X
01382  0E72  A8                    TAY
01383  0E73  9D 00 04              STA SCREEN_BLOCK1,X
01384  0E76  E8                    INX
01385  0E77  E0 FF                 CPX #255
01386  0E79  D0 F4                 BNE @BLOCK1
01387  0E7B  A2 00                 LDX #0
01388  0E7D             @BLOCK2
01389  0E7D  BD FF 54              LDA TITLE_BLOCK2,X
01390  0E80  A8                    TAY
01391  0E81  9D FF 04              STA SCREEN_BLOCK2,X
01392  0E84  E8                    INX
01393  0E85  E0 FF                 CPX #255
01394  0E87  D0 F4                 BNE @BLOCK2
01395  0E89  A2 00                 LDX #0
01396  0E8B             @BLOCK3
01397  0E8B  BD FE 55              LDA TITLE_BLOCK3,X
01398  0E8E  A8                    TAY
01399  0E8F  9D FE 05              STA SCREEN_BLOCK3,X
01400  0E92  E8                    INX
01401  0E93  E0 FF                 CPX #255
01402  0E95  D0 F4                 BNE @BLOCK3
01403  0E97  A2 00                 LDX #0
01404  0E99             @BLOCK4
01405  0E99  BD FD 56              LDA TITLE_BLOCK4,X
01406  0E9C  A8                    TAY
01407  0E9D  9D FD 06              STA SCREEN_BLOCK4,X
01408  0EA0  E8                    INX
01409  0EA1  E0 FF                 CPX #255
01410  0EA3  D0 F4                 BNE @BLOCK4
01411  0EA5  A2 00                 LDX #0
01412  0EA7  60                    RTS
01413  0EA8  60                    RTS
01414  0EA9             
01415  0EA9             DRAWFOREVER 
01416  0EA9                        ;DRAWSCREEN FOREVER_BLOCK1,FOREVER_BLOCK2,FOREVER_BLOCK3,FOREVER_BLOCK4
01417  0EA9  A6 F0                 LDX 240
01418  0EAB             @BLOCK2
01419  0EAB  BD FF 58              LDA FOREVER_BLOCK2,X
01420  0EAE  A8                    TAY
01421  0EAF  9D FF 04              STA SCREEN_BLOCK2,X
01422  0EB2  E8                    INX
01423  0EB3  E0 FF                 CPX #255
01424  0EB5  D0 F4                 BNE @BLOCK2
01425  0EB7  A2 00                 LDX #0
01426  0EB9             @BLOCK3
01427  0EB9  BD FE 59              LDA FOREVER_BLOCK3,X
01428  0EBC  A8                    TAY
01429  0EBD  9D FE 05              STA SCREEN_BLOCK3,X
01430  0EC0  E8                    INX
01431  0EC1  E0 FF                 CPX #255
01432  0EC3  D0 F4                 BNE @BLOCK3
01433  0EC5  A2 00                 LDX #0
01434  0EC7             @BLOCK4
01435  0EC7  BD FD 5A              LDA FOREVER_BLOCK4,X
01436  0ECA  A8                    TAY
01437  0ECB  9D FD 06              STA SCREEN_BLOCK4,X
01438  0ECE  E8                    INX
01439  0ECF  E0 FF                 CPX #255
01440  0ED1  D0 F4                 BNE @BLOCK4
01441  0ED3  A2 00                 LDX #0
01442  0ED5  60                    RTS
01443  0ED6             
01444  0ED6             CHECKFORWALLCOLLISION 
01445  0ED6  AD 1F D0              LDA SPRITE_BG_COLLISION
01446  0ED9  A8                    TAY
01447  0EDA  29 02                 AND #%00000010
01448  0EDC  D0 7D                 BNE DESTROYBULLET
01449  0EDE  98                    TYA
01450  0EDF  29 01                 AND #%00000001
01451  0EE1  D0 61                 BNE KILLPLAYER
01452  0EE3             @CONTINUE
01453  0EE3  60                    RTS
01454  0EE4             
01455  0EE4             CHECKFORSPRITECOLLISION 
01456  0EE4  AD 1E D0              LDA SPRITE_COLLISIONS
01457  0EE7  C9 05                 CMP #%00000101 ; PLAYER AND DOOR 1
01458  0EE9  F0 59                 BEQ KILLPLAYER
01459  0EEB  C9 06                 CMP #%00000110 ; DOOR1 AND BULLET
01460  0EED  F0 6C                 BEQ DESTROYBULLET
01461  0EEF  C9 09                 CMP #%00001001 ; DOOR 2 AND PLAYER
01462  0EF1  F0 51                 BEQ KILLPLAYER
01463  0EF3  C9 0A                 CMP #%00001010 ; DOOR 2 AND BULLET
01464  0EF5  F0 64                 BEQ DESTROYBULLET
01465  0EF7  C9 12                 CMP #%00010010 ; BULLET AND BUTTON 1
01466  0EF9  F0 25                 BEQ OPENDOOR1
01467  0EFB  C9 22                 CMP #%00100010
01468  0EFD  F0 33                 BEQ OPENDOOR2
01469  0EFF  C9 42                 CMP #%01000010
01470  0F01  F0 05                 BEQ KILLNPC1
01471  0F03  C9 82                 CMP #%10000010
01472  0F05  F0 0D                 BEQ KILLNPC2
01473  0F07  60                    RTS
01474  0F08             KILLNPC1
01475  0F08  20 5B 0F              JSR DESTROYBULLET
01476  0F0B             
01477  0F0B             
01478  0F0B  AD 15 D0              LDA SPRITE_ENABLED
01479  0F0E  29 BF                 AND #%10111111
01480  0F10  8D 15 D0              STA SPRITE_ENABLED
01481  0F13  60                    RTS
01482  0F14             KILLNPC2
01483  0F14  20 5B 0F              JSR DESTROYBULLET
01484  0F17             
01485  0F17             
01486  0F17  AD 15 D0              LDA SPRITE_ENABLED
01487  0F1A  29 7F                 AND #%01111111
01488  0F1C  8D 15 D0              STA SPRITE_ENABLED
01489  0F1F  60                    RTS
01490  0F20             OPENDOOR1
01491  0F20  20 5B 0F              JSR DESTROYBULLET
01492  0F23  AD 6D 2A              LDA BUTTON_FRAME3
01493  0F26  8D 68 2A              STA BUTTON_SPRITE_INDEX
01494  0F29  20 FE 0D              JSR UPDATEBUTTONSPRITE
01495  0F2C  A9 01                 LDA #1
01496  0F2E  8D 07 70              STA DOOR1_OPEN_COUNTER
01497  0F31  60                    RTS
01498  0F32             
01499  0F32             OPENDOOR2
01500  0F32  20 5B 0F              JSR DESTROYBULLET
01501  0F35  AD 6D 2A              LDA BUTTON_FRAME3
01502  0F38  8D 6E 2A              STA BUTTON2_SPRITE_INDEX
01503  0F3B  20 05 0E              JSR UPDATEBUTTON2SPRITE
01504  0F3E  A9 01                 LDA #1
01505  0F40  8D 08 70              STA DOOR2_OPEN_COUNTER
01506  0F43  60                    RTS
01507  0F44             
01508  0F44             KILLPLAYER 
01509  0F44  AE 00 70              LDX PLAYER_DYING_COUNTER
01510  0F47  E8                    INX
01511  0F48  8E 00 70              STX PLAYER_DYING_COUNTER
01512  0F4B  A9 89                 LDA PLAYER_DYING_ANIM1
01513  0F4D  8D 44 2A              STA PLAYER_SPRITE_INDEX
01514  0F50  AE 01 70              LDX PLAYER_LIVES
01515  0F53  CA                    DEX
01516  0F54  8E 01 70              STX PLAYER_LIVES
01517  0F57  20 5B 0F              JSR DESTROYBULLET
01518  0F5A  60                    RTS
01519  0F5B             
01520  0F5B             DESTROYBULLET 
01521  0F5B                        ;DISABLESPRITE #%11111101
01522  0F5B  AD 06 70              LDA PLAYER_BULLET_EXPLOSION_COUNTER
01523  0F5E  C9 00                 CMP #0
01524  0F60  D0 05                 BNE @CONT
01525  0F62  A9 01                 LDA #1
01526  0F64  8D 06 70              STA PLAYER_BULLET_EXPLOSION_COUNTER
01527  0F67             @CONT
01528  0F67  60                    RTS
01529  0F68             
01530  0F68             INITPLAYERSTATE 
01531  0F68  A2 09                 LDX #9
01532  0F6A  8E 01 70              STX PLAYER_LIVES
01533  0F6D  A2 01                 LDX PLAYER_ACTION_SHOOT
01534  0F6F  8E 03 70              STX PLAYER_CURRENT_ACTION
01535  0F72  A2 00                 LDX #0
01536  0F74  8E 04 70              STX PLAYER_ACTION_SWITCH_COOLDOWN
01537  0F77  60                    RTS
01538  0F78             
01539  0F78             
01540  0F78             PLAYFOOTSTEP 
01541  0F78             
01542  0F78             
01543  0F78  A9 04                 LDA #4
01544  0F7A  8D 18 D4              STA SID_VOLUME
01545  0F7D  A9 00                 LDA #0
01546  0F7F  8D 00 D4              STA SID_VOICE1_LO_FREQ
01547  0F82  A9 80                 LDA #128
01548  0F84  8D 01 D4              STA SID_VOICE1_HI_FREQ
01549  0F87  A9 80                 LDA #128
01550  0F89  8D 05 D4              STA SID_ATTACK_DECAY
01551  0F8C  A9 01                 LDA #1
01552  0F8E  8D 06 D4              STA SID_SUSTAIN
01553  0F91  A9 00                 LDA #0
01554  0F93  8D 04 D4              STA SID_VOICE1_CONTROL
01555  0F96  A9 41                 LDA #65
01556  0F98  8D 04 D4              STA SID_VOICE1_CONTROL
01557  0F9B  60                    RTS
01558  0F9C             
01559  0F9C             PLAYZAP
01560  0F9C             
01561  0F9C             
01562  0F9C  A9 19                 LDA #25
01563  0F9E  8D 18 D4              STA SID_VOLUME
01564  0FA1  A9 00                 LDA #0
01565  0FA3  8D 00 D4              STA SID_VOICE1_LO_FREQ
01566  0FA6  A9 28                 LDA #40
01567  0FA8  8D 01 D4              STA SID_VOICE1_HI_FREQ
01568  0FAB  A9 16                 LDA #22
01569  0FAD  8D 05 D4              STA SID_ATTACK_DECAY
01570  0FB0  A9 07                 LDA #7
01571  0FB2  8D 06 D4              STA SID_SUSTAIN
01572  0FB5  A9 00                 LDA #0
01573  0FB7  8D 04 D4              STA SID_VOICE1_CONTROL
01574  0FBA  A9 81                 LDA #129
01575  0FBC  8D 04 D4              STA SID_VOICE1_CONTROL
01576  0FBF  60                    RTS
01577  0FC0             
01578  0FC0             PLAYLASER
01579  0FC0             
01580  0FC0             
01581  0FC0  A9 19                 LDA #25
01582  0FC2  8D 18 D4              STA SID_VOLUME
01583  0FC5  A9 14                 LDA #20
01584  0FC7  8D 00 D4              STA SID_VOICE1_LO_FREQ
01585  0FCA  A9 2C                 LDA #44
01586  0FCC  8D 01 D4              STA SID_VOICE1_HI_FREQ
01587  0FCF  A9 58                 LDA #88
01588  0FD1  8D 05 D4              STA SID_ATTACK_DECAY
01589  0FD4  A9 03                 LDA #3
01590  0FD6  8D 06 D4              STA SID_SUSTAIN
01591  0FD9  A9 00                 LDA #0
01592  0FDB  8D 04 D4              STA SID_VOICE1_CONTROL
01593  0FDE  A9 21                 LDA #33
01594  0FE0  8D 04 D4              STA SID_VOICE1_CONTROL
01595  0FE3  60                    RTS
01596  0FE4             
01597  0FE4             
01598  0FE4             UPDATELASTAIMDIR 
01599  0FE4  AD 44 2A              LDA PLAYER_SPRITE_INDEX
01600  0FE7  C9 8B                 CMP PLAYER_SHOOT_N
01601  0FE9  F0 1D                 BEQ @SETAIMDIR
01602  0FEB  C9 8D                 CMP PLAYER_SHOOT_E
01603  0FED  F0 19                 BEQ @SETAIMDIR
01604  0FEF  C9 8F                 CMP PLAYER_SHOOT_S
01605  0FF1  F0 15                 BEQ @SETAIMDIR
01606  0FF3  C9 91                 CMP PLAYER_SHOOT_W
01607  0FF5  F0 11                 BEQ @SETAIMDIR
01608  0FF7  C9 8C                 CMP PLAYER_SHOOT_NE
01609  0FF9  F0 0D                 BEQ @SETAIMDIR
01610  0FFB  C9 92                 CMP PLAYER_SHOOT_NW
01611  0FFD  F0 09                 BEQ @SETAIMDIR
01612  0FFF  C9 8E                 CMP PLAYER_SHOOT_SE
01613  1001  F0 05                 BEQ @SETAIMDIR
01614  1003  C9 90                 CMP PLAYER_SHOOT_SW
01615  1005  F0 01                 BEQ @SETAIMDIR
01616  1007  60                    RTS
01617  1008             @SETAIMDIR 
01618  1008  AD 44 2A              LDA PLAYER_SPRITE_INDEX
01619  100B  8D 05 70              STA PLAYER_BULLET_DIRECTION
01620  100E  60                    RTS
01621  100F             
01622  100F             HANDLEACTION 
01623  100F  20 16 10              JSR @PROCESS
01624  1012  20 E4 0F              JSR UPDATELASTAIMDIR
01625  1015  60                    RTS
01626  1016             @PROCESS
01627  1016                        ;JSR CHECKFORSELECTEDACTIONCHANGE
01628  1016  20 95 11              JSR CHECKFORACTION
01629  1019  20 4A 0B              JSR READJOYSTICK1
01630  101C  A5 02                 LDA JOYSTICK_INPUT1
01631  101E  29 02                 AND PLAYER_MOVED_UP
01632  1020  D0 13                 BNE @SHOOTUP
01633  1022  A5 02                 LDA JOYSTICK_INPUT1
01634  1024  29 08                 AND PLAYER_MOVED_DOWN
01635  1026  D0 3D                 BNE @SHOOTDOWN
01636  1028  A5 02                 LDA JOYSTICK_INPUT1
01637  102A  29 10                 AND PLAYER_MOVED_LEFT
01638  102C  D0 67                 BNE @SHOOTLEFT
01639  102E  A5 02                 LDA JOYSTICK_INPUT1
01640  1030  29 04                 AND PLAYER_MOVED_RIGHT
01641  1032  D0 6D                 BNE @SHOOTRIGHT
01642  1034  60                    RTS
01643  1035             @SHOOTUP
01644  1035  A5 02                 LDA JOYSTICK_INPUT1
01645  1037  29 04                 AND PLAYER_MOVED_RIGHT
01646  1039  D0 12                 BNE @SHOOTUPRIGHT
01647  103B  A5 02                 LDA JOYSTICK_INPUT1
01648  103D  29 10                 AND PLAYER_MOVED_LEFT
01649  103F  D0 18                 BNE @SHOOTUPLEFT
01650  1041  A9 8B                 LDA PLAYER_SHOOT_N
01651  1043  8D 44 2A              STA PLAYER_SPRITE_INDEX
01652  1046  AD 50 2A              LDA PLAYER_BULLET_VERT
01653  1049  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01654  104C  60                    RTS
01655  104D             @SHOOTUPRIGHT 
01656  104D  A9 8C                 LDA PLAYER_SHOOT_NE
01657  104F  8D 44 2A              STA PLAYER_SPRITE_INDEX
01658  1052  AD 52 2A              LDA PLAYER_BULLET_SWNE
01659  1055  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01660  1058  60                    RTS
01661  1059             @SHOOTUPLEFT 
01662  1059  A9 92                 LDA PLAYER_SHOOT_NW
01663  105B  8D 44 2A              STA PLAYER_SPRITE_INDEX
01664  105E  AD 51 2A              LDA PLAYER_BULLET_NWSE
01665  1061  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01666  1064  60                    RTS
01667  1065             @SHOOTDOWN 
01668  1065  A5 02                 LDA JOYSTICK_INPUT1
01669  1067  29 04                 AND PLAYER_MOVED_RIGHT
01670  1069  D0 12                 BNE @SHOOTDOWNRIGHT
01671  106B  A5 02                 LDA JOYSTICK_INPUT1
01672  106D  29 10                 AND PLAYER_MOVED_LEFT
01673  106F  D0 18                 BNE @SHOOTDOWNLEFT
01674  1071  A9 8F                 LDA PLAYER_SHOOT_S
01675  1073  8D 44 2A              STA PLAYER_SPRITE_INDEX
01676  1076  AD 50 2A              LDA PLAYER_BULLET_VERT
01677  1079  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01678  107C  60                    RTS
01679  107D             @SHOOTDOWNRIGHT 
01680  107D  A9 8E                 LDA PLAYER_SHOOT_SE
01681  107F  8D 44 2A              STA PLAYER_SPRITE_INDEX
01682  1082  AD 51 2A              LDA PLAYER_BULLET_NWSE
01683  1085  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01684  1088  60                    RTS
01685  1089             @SHOOTDOWNLEFT 
01686  1089  A9 90                 LDA PLAYER_SHOOT_SW
01687  108B  8D 44 2A              STA PLAYER_SPRITE_INDEX
01688  108E  AD 52 2A              LDA PLAYER_BULLET_SWNE
01689  1091  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01690  1094  60                    RTS
01691  1095             @SHOOTLEFT 
01692  1095  A9 91                 LDA PLAYER_SHOOT_W
01693  1097  8D 44 2A              STA PLAYER_SPRITE_INDEX
01694  109A  AD 4F 2A              LDA PLAYER_BULLET_HORI
01695  109D  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01696  10A0  60                    RTS
01697  10A1             @SHOOTRIGHT 
01698  10A1  A9 8D                 LDA PLAYER_SHOOT_E
01699  10A3  8D 44 2A              STA PLAYER_SPRITE_INDEX
01700  10A6  AD 4F 2A              LDA PLAYER_BULLET_HORI
01701  10A9  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01702  10AC  60                    RTS
01703  10AD             CHECKFORSELECTEDACTIONCHANGE 
01704  10AD  A5 02                 LDA JOYSTICK_INPUT1
01705  10AF  29 01                 AND PLAYER_ACTION
01706  10B1  D0 01                 BNE @UPDATEACTION
01707  10B3  60                    RTS
01708  10B4             @UPDATEACTION 
01709  10B4  AE 04 70              LDX PLAYER_ACTION_SWITCH_COOLDOWN
01710  10B7  E8                    INX
01711  10B8  8E 04 70              STX PLAYER_ACTION_SWITCH_COOLDOWN
01712  10BB  E0 01                 CPX #1
01713  10BD  F0 39                 BEQ @PROCESSACTIONUPDATE
01714  10BF  E0 10                 CPX #16
01715  10C1  F0 35                 BEQ @PROCESSACTIONUPDATE
01716  10C3  E0 20                 CPX #32
01717  10C5  F0 31                 BEQ @PROCESSACTIONUPDATE
01718  10C7  E0 30                 CPX #48
01719  10C9  F0 2D                 BEQ @PROCESSACTIONUPDATE
01720  10CB  E0 40                 CPX #64
01721  10CD  F0 29                 BEQ @PROCESSACTIONUPDATE
01722  10CF  E0 50                 CPX #80
01723  10D1  F0 25                 BEQ @PROCESSACTIONUPDATE
01724  10D3  E0 60                 CPX #96
01725  10D5  F0 21                 BEQ @PROCESSACTIONUPDATE
01726  10D7  E0 6E                 CPX #110
01727  10D9  F0 1D                 BEQ @PROCESSACTIONUPDATE
01728  10DB  E0 80                 CPX #128
01729  10DD  F0 19                 BEQ @PROCESSACTIONUPDATE
01730  10DF  E0 8E                 CPX #142
01731  10E1  F0 15                 BEQ @PROCESSACTIONUPDATE
01732  10E3  E0 A0                 CPX #160
01733  10E5  F0 11                 BEQ @PROCESSACTIONUPDATE
01734  10E7  E0 B0                 CPX #176
01735  10E9  F0 0D                 BEQ @PROCESSACTIONUPDATE
01736  10EB  E0 C6                 CPX #198
01737  10ED  F0 09                 BEQ @PROCESSACTIONUPDATE
01738  10EF  E0 D6                 CPX #214
01739  10F1  F0 05                 BEQ @PROCESSACTIONUPDATE
01740  10F3  E0 E6                 CPX #230
01741  10F5  F0 01                 BEQ @PROCESSACTIONUPDATE
01742  10F7  60                    RTS
01743  10F8             @PROCESSACTIONUPDATE 
01744  10F8  20 6E 11              JSR RESETACTIONSELECTOR
01745  10FB  AD 03 70              LDA PLAYER_CURRENT_ACTION
01746  10FE  C9 01                 CMP PLAYER_ACTION_SHOOT
01747  1100  F0 2A                 BEQ SETACTIONTALK
01748  1102  C9 02                 CMP PLAYER_ACTION_TALK
01749  1104  F0 47                 BEQ SETACTIONUSE
01750  1106  C9 04                 CMP PLAYER_ACTION_USE
01751  1108  F0 01                 BEQ SETACTIONSHOOT
01752  110A  60                    RTS
01753  110B             SETACTIONSHOOT 
01754  110B  A2 01                 LDX PLAYER_ACTION_SHOOT
01755  110D  8E 03 70              STX PLAYER_CURRENT_ACTION
01756  1110  20 6E 11              JSR RESETACTIONSELECTOR
01757  1113  AE 40 2A              LDX BOX_SELECTOR_TL
01758  1116  8E 95 07              STX ACTION_SELECTOR_POS1
01759  1119  AE 41 2A              LDX BOX_SELECTOR_TR
01760  111C  8E 97 07              STX ACTION_SELECTOR_POS2
01761  111F  AE 42 2A              LDX BOX_SELECTOR_BL
01762  1122  8E E5 07              STX ACTION_SELECTOR_POS3
01763  1125  AE 43 2A              LDX BOX_SELECTOR_BR
01764  1128  8E E7 07              STX ACTION_SELECTOR_POS4
01765  112B  60                    RTS
01766  112C             SETACTIONTALK 
01767  112C  A2 02                 LDX PLAYER_ACTION_TALK
01768  112E  8E 03 70              STX PLAYER_CURRENT_ACTION
01769  1131  20 6E 11              JSR RESETACTIONSELECTOR
01770  1134  AE 40 2A              LDX BOX_SELECTOR_TL
01771  1137  8E 45 07              STX ACTION_SELECTOR_POS5
01772  113A  AE 41 2A              LDX BOX_SELECTOR_TR
01773  113D  8E 47 07              STX ACTION_SELECTOR_POS6
01774  1140  AE 42 2A              LDX BOX_SELECTOR_BL
01775  1143  8E 95 07              STX ACTION_SELECTOR_POS7
01776  1146  AE 43 2A              LDX BOX_SELECTOR_BR
01777  1149  8E 97 07              STX ACTION_SELECTOR_POS8
01778  114C  60                    RTS
01779  114D             SETACTIONUSE 
01780  114D  A2 04                 LDX PLAYER_ACTION_USE
01781  114F  8E 03 70              STX PLAYER_CURRENT_ACTION
01782  1152  20 6E 11              JSR RESETACTIONSELECTOR
01783  1155  AE 40 2A              LDX BOX_SELECTOR_TL
01784  1158  8E F5 06              STX ACTION_SELECTOR_POS9
01785  115B  AE 41 2A              LDX BOX_SELECTOR_TR
01786  115E  8E F7 06              STX ACTION_SELECTOR_POS10
01787  1161  AE 42 2A              LDX BOX_SELECTOR_BL
01788  1164  8E 45 07              STX ACTION_SELECTOR_POS11
01789  1167  AE 43 2A              LDX BOX_SELECTOR_BR
01790  116A  8E 47 07              STX ACTION_SELECTOR_POS12
01791  116D  60                    RTS
01792  116E             RESETACTIONSELECTOR 
01793  116E  A2 20                 LDX #32
01794  1170  8E 95 07              STX ACTION_SELECTOR_POS1
01795  1173  8E 97 07              STX ACTION_SELECTOR_POS2
01796  1176  8E E5 07              STX ACTION_SELECTOR_POS3
01797  1179  8E E7 07              STX ACTION_SELECTOR_POS4
01798  117C  8E 45 07              STX ACTION_SELECTOR_POS5
01799  117F  8E 47 07              STX ACTION_SELECTOR_POS6
01800  1182  8E 95 07              STX ACTION_SELECTOR_POS7
01801  1185  8E 97 07              STX ACTION_SELECTOR_POS8
01802  1188  8E F5 06              STX ACTION_SELECTOR_POS9
01803  118B  8E F7 06              STX ACTION_SELECTOR_POS10
01804  118E  8E 45 07              STX ACTION_SELECTOR_POS11
01805  1191  8E 47 07              STX ACTION_SELECTOR_POS12
01806  1194  60                    RTS
01807  1195             CHECKFORACTION 
01808  1195  20 CE 13              JSR TOGGLETILES
01809  1198  AD 15 D0              LDA SPRITE_ENABLED
01810  119B  29 02                 AND #%00000010
01811  119D  F0 04                 BEQ @ACTIONCANPROCEED
01812  119F  20 E8 11              JSR @MOVEBULLET
01813  11A2                        
01814  11A2  60                    RTS
01815  11A3             @ACTIONCANPROCEED 
01816  11A3  20 EB 0A              JSR READJOYSTICK
01817  11A6  A5 02                 LDA JOYSTICK_INPUT
01818  11A8  29 01                 AND PLAYER_ACTION
01819  11AA  F0 04                 BEQ @ACTCONT
01820  11AC  20 B1 11              JSR @SHOOT
01821  11AF  60                    RTS
01822  11B0             @ACTCONT
01823  11B0  60                    RTS
01824  11B1             @SHOOT
01825  11B1  20 C0 0F              JSR PLAYLASER
01826  11B4  AE 45 2A              LDX PLAYER_X
01827  11B7  8E 4D 2A              STX PLAYER_BULLET_X
01828  11BA  AC 46 2A              LDY PLAYER_Y
01829  11BD  8C 4E 2A              STY PLAYER_BULLET_Y
01830  11C0             
01831  11C0             
01832  11C0  AD 15 D0              LDA SPRITE_ENABLED
01833  11C3  09 02                 ORA #%00000010
01834  11C5  8D 15 D0              STA SPRITE_ENABLED
01835  11C8  20 F0 0C              JSR UPDATEPLAYERBULLETPOSITION
01836  11CB  AD 10 D0              LDA SPRITE_OVERFLOW
01837  11CE  29 01                 AND #%00000001
01838  11D0  D0 04                 BNE @SETBULLETXOVERFLOWON
01839  11D2  20 DF 11              JSR @SETBULLETXOVERFLOWOFF
01840  11D5                        ;JSR UPDATEPLAYERBULLETSPRITE
01841  11D5  60                    RTS
01842  11D6             @SETBULLETXOVERFLOWON 
01843  11D6  AD 10 D0              LDA SPRITE_OVERFLOW
01844  11D9  09 02                 ORA #%00000010
01845  11DB  8D 10 D0              STA SPRITE_OVERFLOW
01846  11DE  60                    RTS
01847  11DF             @SETBULLETXOVERFLOWOFF 
01848  11DF  AD 10 D0              LDA SPRITE_OVERFLOW
01849  11E2  29 FD                 AND #%11111101
01850  11E4  8D 10 D0              STA SPRITE_OVERFLOW
01851  11E7  60                    RTS
01852  11E8             @MOVEBULLET 
01853  11E8  AD 4D 2A              LDA PLAYER_BULLET_X
01854  11EB  C9 FF                 CMP #255
01855  11ED  F0 0B                 BEQ @CHECKFORBULLETOVERFLOW
01856  11EF  C9 00                 CMP #0
01857  11F1  F0 1D                 BEQ @CHECKFORBULLETOVERFLOWL
01858  11F3  20 42 12              JSR @PROCESS
01859  11F6  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
01860  11F9  60                    RTS
01861  11FA             @CHECKFORBULLETOVERFLOW 
01862  11FA  AD 05 70              LDA PLAYER_BULLET_DIRECTION
01863  11FD  C9 8D                 CMP PLAYER_SHOOT_E
01864  11FF  F0 33                 BEQ @BULLETOVERFLOWRIGHT
01865  1201  C9 8C                 CMP PLAYER_SHOOT_NE
01866  1203  F0 2F                 BEQ @BULLETOVERFLOWRIGHT
01867  1205  C9 8E                 CMP PLAYER_SHOOT_SE
01868  1207  F0 2B                 BEQ @BULLETOVERFLOWRIGHT
01869  1209  20 42 12              JSR @PROCESS
01870  120C  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
01871  120F  60                    RTS
01872  1210             @CHECKFORBULLETOVERFLOWL 
01873  1210  AD 05 70              LDA PLAYER_BULLET_DIRECTION
01874  1213  C9 91                 CMP PLAYER_SHOOT_W
01875  1215  F0 0F                 BEQ @BULLETOVERFLOWLEFT
01876  1217  C9 90                 CMP PLAYER_SHOOT_SW
01877  1219  F0 0B                 BEQ @BULLETOVERFLOWLEFT
01878  121B  C9 92                 CMP PLAYER_SHOOT_NW
01879  121D  F0 07                 BEQ @BULLETOVERFLOWLEFT
01880  121F  20 42 12              JSR @PROCESS
01881  1222  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
01882  1225  60                    RTS
01883  1226             @BULLETOVERFLOWLEFT 
01884  1226  AD 10 D0              LDA SPRITE_OVERFLOW
01885  1229  29 FD                 AND #%11111101
01886  122B  8D 10 D0              STA SPRITE_OVERFLOW
01887  122E  A9 FF                 LDA #255
01888  1230  8D 4D 2A              STA PLAYER_BULLET_X
01889  1233  60                    RTS
01890  1234             @BULLETOVERFLOWRIGHT 
01891  1234  AD 10 D0              LDA SPRITE_OVERFLOW
01892  1237  09 02                 ORA #%00000010
01893  1239  8D 10 D0              STA SPRITE_OVERFLOW
01894  123C  A9 00                 LDA #0
01895  123E  8D 4D 2A              STA PLAYER_BULLET_X
01896  1241  60                    RTS
01897  1242             @PROCESS
01898  1242  AD 06 70              LDA PLAYER_BULLET_EXPLOSION_COUNTER
01899  1245  C9 00                 CMP #0
01900  1247  F0 01                 BEQ @CONTINUEPROCESSING
01901  1249  60                    RTS
01902  124A             @CONTINUEPROCESSING 
01903  124A  AD 05 70              LDA PLAYER_BULLET_DIRECTION
01904  124D  C9 8B                 CMP PLAYER_SHOOT_N
01905  124F  F0 1D                 BEQ @MOVEBULLETN
01906  1251  C9 8D                 CMP PLAYER_SHOOT_E
01907  1253  F0 27                 BEQ @MOVEBULLETE
01908  1255  C9 8F                 CMP PLAYER_SHOOT_S
01909  1257  F0 3F                 BEQ @MOVEBULLETS
01910  1259  C9 91                 CMP PLAYER_SHOOT_W
01911  125B  F0 2D                 BEQ @MOVEBULLETW
01912  125D  C9 8C                 CMP PLAYER_SHOOT_NE
01913  125F  F0 5A                 BEQ @MOVEBULLETNE
01914  1261  C9 92                 CMP PLAYER_SHOOT_NW
01915  1263  F0 41                 BEQ @MOVEBULLETNW
01916  1265  C9 8E                 CMP PLAYER_SHOOT_SE
01917  1267  F0 7C                 BEQ @MOVEBULLETSE
01918  1269  C9 90                 CMP PLAYER_SHOOT_SW
01919  126B  F0 63                 BEQ @MOVEBULLETSW
01920  126D  60                    RTS
01921  126E             @MOVEBULLETN 
01922  126E  AC 4E 2A              LDY PLAYER_BULLET_Y
01923  1271  88                    DEY
01924  1272  8C 4E 2A              STY PLAYER_BULLET_Y
01925  1275  AD 50 2A              LDA PLAYER_BULLET_VERT
01926  1278  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01927  127B  60                    RTS
01928  127C             @MOVEBULLETE 
01929  127C  AC 4D 2A              LDY PLAYER_BULLET_X
01930  127F  C8                    INY
01931  1280  8C 4D 2A              STY PLAYER_BULLET_X
01932  1283  AD 4F 2A              LDA PLAYER_BULLET_HORI
01933  1286  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01934  1289  60                    RTS
01935  128A             @MOVEBULLETW 
01936  128A  AC 4D 2A              LDY PLAYER_BULLET_X
01937  128D  88                    DEY
01938  128E  8C 4D 2A              STY PLAYER_BULLET_X
01939  1291  AD 4F 2A              LDA PLAYER_BULLET_HORI
01940  1294  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01941  1297  60                    RTS
01942  1298             @MOVEBULLETS 
01943  1298  AC 4E 2A              LDY PLAYER_BULLET_Y
01944  129B  C8                    INY
01945  129C  8C 4E 2A              STY PLAYER_BULLET_Y
01946  129F  AD 50 2A              LDA PLAYER_BULLET_VERT
01947  12A2  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01948  12A5  60                    RTS
01949  12A6             @MOVEBULLETNW 
01950  12A6  AE 4D 2A              LDX PLAYER_BULLET_X
01951  12A9  AC 4E 2A              LDY PLAYER_BULLET_Y
01952  12AC  CA                    DEX
01953  12AD  88                    DEY
01954  12AE  8E 4D 2A              STX PLAYER_BULLET_X
01955  12B1  8C 4E 2A              STY PLAYER_BULLET_Y
01956  12B4  AD 51 2A              LDA PLAYER_BULLET_NWSE
01957  12B7  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01958  12BA  60                    RTS
01959  12BB             @MOVEBULLETNE 
01960  12BB  AE 4D 2A              LDX PLAYER_BULLET_X
01961  12BE  AC 4E 2A              LDY PLAYER_BULLET_Y
01962  12C1  E8                    INX
01963  12C2  88                    DEY
01964  12C3  8E 4D 2A              STX PLAYER_BULLET_X
01965  12C6  8C 4E 2A              STY PLAYER_BULLET_Y
01966  12C9  AD 52 2A              LDA PLAYER_BULLET_SWNE
01967  12CC  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01968  12CF  60                    RTS
01969  12D0             @MOVEBULLETSW 
01970  12D0  AE 4D 2A              LDX PLAYER_BULLET_X
01971  12D3  AC 4E 2A              LDY PLAYER_BULLET_Y
01972  12D6  CA                    DEX
01973  12D7  C8                    INY
01974  12D8  8E 4D 2A              STX PLAYER_BULLET_X
01975  12DB  8C 4E 2A              STY PLAYER_BULLET_Y
01976  12DE  AD 52 2A              LDA PLAYER_BULLET_SWNE
01977  12E1  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01978  12E4  60                    RTS
01979  12E5             @MOVEBULLETSE 
01980  12E5  AE 4D 2A              LDX PLAYER_BULLET_X
01981  12E8  AC 4E 2A              LDY PLAYER_BULLET_Y
01982  12EB  E8                    INX
01983  12EC  C8                    INY
01984  12ED  8E 4D 2A              STX PLAYER_BULLET_X
01985  12F0  8C 4E 2A              STY PLAYER_BULLET_Y
01986  12F3  AD 51 2A              LDA PLAYER_BULLET_NWSE
01987  12F6  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
01988  12F9  60                    RTS
01989  12FA             
01990  12FA             HANDLEBULLETEXPLOSION 
01991  12FA  AE 06 70              LDX PLAYER_BULLET_EXPLOSION_COUNTER
01992  12FD  E0 00                 CPX #0
01993  12FF  F0 6F                 BEQ @CONT
01994  1301  A9 02                 LDA #%00000010
01995  1303  8D 1C D0              STA SPRITE_MULTICOLOUR_ENABLE
01996  1306  20 9C 0F              JSR PLAYZAP
01997  1309  E8                    INX
01998  130A  8E 06 70              STX PLAYER_BULLET_EXPLOSION_COUNTER
01999  130D  E0 02                 CPX #2
02000  130F  F0 15                 BEQ @FRAME1
02001  1311  E0 06                 CPX #6
02002  1313  F0 1B                 BEQ @FRAME2
02003  1315  E0 0C                 CPX #12
02004  1317  F0 21                 BEQ @FRAME3
02005  1319  E0 12                 CPX #18
02006  131B  F0 27                 BEQ @FRAME4
02007  131D  E0 18                 CPX #24
02008  131F  F0 2D                 BEQ @FRAME5
02009  1321  E0 20                 CPX #32
02010  1323  F0 33                 BEQ @DESTROY
02011  1325  60                    RTS
02012  1326             @FRAME1
02013  1326  AD 53 2A              LDA PLAYER_BULLET_EXPLOSION1
02014  1329  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
02015  132C  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
02016  132F  60                    RTS
02017  1330             @FRAME2
02018  1330  AD 54 2A              LDA PLAYER_BULLET_EXPLOSION2
02019  1333  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
02020  1336  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
02021  1339  60                    RTS
02022  133A             @FRAME3
02023  133A  AD 55 2A              LDA PLAYER_BULLET_EXPLOSION3
02024  133D  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
02025  1340  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
02026  1343  60                    RTS
02027  1344             @FRAME4
02028  1344  AD 56 2A              LDA PLAYER_BULLET_EXPLOSION4
02029  1347  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
02030  134A  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
02031  134D  60                    RTS
02032  134E             @FRAME5
02033  134E  AD 57 2A              LDA PLAYER_BULLET_EXPLOSION5
02034  1351  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
02035  1354  20 E9 0D              JSR UPDATEPLAYERBULLETSPRITE
02036  1357  60                    RTS
02037  1358             @DESTROY
02038  1358  A9 00                 LDA #%00000000
02039  135A  8D 1C D0              STA SPRITE_MULTICOLOUR_ENABLE
02040  135D  A9 00                 LDA #0
02041  135F  8D 06 70              STA PLAYER_BULLET_EXPLOSION_COUNTER
02042  1362             
02043  1362             
02044  1362  AD 15 D0              LDA SPRITE_ENABLED
02045  1365  29 FD                 AND #%11111101
02046  1367  8D 15 D0              STA SPRITE_ENABLED
02047  136A  AD 4F 2A              LDA PLAYER_BULLET_HORI
02048  136D  8D 4C 2A              STA PLAYER_BULLET_SPRITE_INDEX
02049  1370             @CONT
02050  1370  60                    RTS
02051  1371             
02052  1371             HANDLETALK 
02053  1371  20 EB 0A              JSR READJOYSTICK
02054  1374  A5 02                 LDA JOYSTICK_INPUT
02055  1376  C9 01                 CMP PLAYER_ACTION
02056  1378  F0 03                 BEQ @PROCESSTALK
02057  137A  4C 66 08              JMP GAMELOOP
02058  137D             @PROCESSTALK 
02059  137D  38                    SEC
02060  137E  AD 45 2A              LDA PLAYER_X
02061  1381                        
02062  1381  ED 76 2A              SBC NPC1_X
02063  1384  C9 10                 CMP #16
02064  1386  90 09                 BCC @CHECKNPC1Y
02065  1388  C9 EF                 CMP #239
02066  138A  F0 16                 BEQ @CHECKNPC2
02067  138C  B0 03                 BCS @CHECKNPC1Y
02068  138E             @CONTTALK
02069  138E  4C 66 08              JMP GAMELOOP
02070  1391             @CHECKNPC1Y 
02071  1391  38                    SEC
02072  1392  AD 46 2A              LDA PLAYER_Y
02073  1395  ED 77 2A              SBC NPC1_Y
02074  1398  C9 10                 CMP #16
02075  139A  90 29                 BCC @TALKTONPC1
02076  139C  C9 EF                 CMP #239
02077  139E  F0 02                 BEQ @CHECKNPC2
02078  13A0  B0 23                 BCS @TALKTONPC1
02079  13A2             @CHECKNPC2 
02080  13A2  38                    SEC
02081  13A3  AD 45 2A              LDA PLAYER_X
02082  13A6                        
02083  13A6  ED 78 2A              SBC NPC2_X
02084  13A9  C9 10                 CMP #16
02085  13AB  90 06                 BCC @CHECKNPC2Y
02086  13AD  C9 EF                 CMP #239
02087  13AF  F0 DD                 BEQ @CONTTALK
02088  13B1  B0 00                 BCS @CHECKNPC2Y
02089  13B3             @CHECKNPC2Y 
02090  13B3  38                    SEC
02091  13B4  AD 46 2A              LDA PLAYER_Y
02092  13B7  ED 79 2A              SBC NPC2_Y
02093  13BA  C9 10                 CMP #16
02094  13BC  90 0B                 BCC @TALKTONPC2
02095  13BE  C9 EF                 CMP #239
02096  13C0  B0 07                 BCS @TALKTONPC2
02097  13C2  4C 66 08              JMP GAMELOOP
02098  13C5             @TALKTONPC1 
02099  13C5  20 CD 13              JSR @DRAWDIALOGUE
02100  13C8  60                    RTS
02101  13C9             @TALKTONPC2 
02102  13C9  20 CD 13              JSR @DRAWDIALOGUE
02103  13CC  60                    RTS
02104  13CD             @DRAWDIALOGUE 
02105  13CD                        
02106  13CD  60                    RTS
02107  13CE             TOGGLETILES 
02108  13CE                        ;LDX LEVEL1_TILE_COUNTER
02109  13CE                        ;INX
02110  13CE                        ;STX LEVEL1_TILE_COUNTER
02111  13CE                        ;CPX #128
02112  13CE                        ;BEQ TURNOFFTILES
02113  13CE                        ;CPX #255
02114  13CE  F0 04                 BEQ TURNONTILES
02115  13D0  60                    RTS
02116  13D1             TURNOFFTILES 
02117  13D1  A9 20                 LDA #32
02118  13D3             
02119  13D3             
02120  13D3             
02121  13D3             
02122  13D3             
02123  13D3             
02124  13D3             
02125  13D3             
02126  13D3             
02127  13D3                        
02128  13D3  60                    RTS
02129  13D4             
02130  13D4             TURNONTILES 
02131  13D4  A9 58                 LDA #88
02132  13D6             
02133  13D6             
02134  13D6             
02135  13D6             
02136  13D6             
02137  13D6             
02138  13D6             
02139  13D6             
02140  13D6             
02141  13D6  A9 00                 LDA #0
02142  13D8  8D 09 70              STA LEVEL1_TILE_COUNTER
02143  13DB  60                    RTS
02144  13DC             
02145  13DC             
02146  13DC             ; FLAVOUR TEXT
02147  13DC  04 0F 20   FT_LEVEL1  TEXT 'DO YOU WISH TO LAPSE IN LIMBO FOREVER?  NO! NO! BE RESOLUTE! FREE YOUR MIND OF  ANGER AND AGGRESSION IF YOU EVER WANT TOEND THIS FUTURE DREAM.'
02148  146A  00                    BYTE 00
02149  146B  19 0F 15   FT_LEVEL2  TEXT 'YOU ARE THREE SOULS OF THE FLESH, CHOSEN FROM DIFFERENT ERAS ANCIENT AND MODERN, REPRESENTATIVES OF YOUR OWN CHERISHED TIME. THE TRIVIA OF YOUR MORTAL LIVES IS UNIMPORTANT TO ME. INDEED, SOME MAY DIE.'
02150  1533  00                    BYTE 00
02151  1534  0C 0F 0F   FT_LEVEL2P2 TEXT 'LOOK AROUND, BUT LINGER NOT. WHERE I LEAD YOU WILL FOLLOW. MARK THESE WORDS WELL: IGNITE MY ANGER WITH YOUR DELAY AND PUNISHMENTS WILL COME YOUR WAY.'
02152  15C9  00                    BYTE 00
02153  15CA  14 08 05   FT_LEVEL2P3 TEXT 'THERE IS DANGER AHEAD, BUT DO NOT BE AFRAID. FOR I AM WITH YOU, AS WATER, AS AIR, AS BREATH ITSELF IN THIS PLACE OF NO TIME AND NO SPACE. BE RESOLUTE. THERE ARE TRIALS AHEAD... AND REWARDS FOR THOSE WHO STRIVE.'
02154  169C  00                    BYTE 00
02155  169D  19 0F 15   FT_LEVEL2P4 TEXT 'YOU HAVE A TASK! TO RELEASE YOURSELVES FROM THIS WEB OF WISDOM, THIS KNOTTED MAZE OF DELERIUM YOU MUST ENTER THE NUCLEAR PORTALS OF THE ELECTRIC CASTLE!'
02156  1735  00                    BYTE 00
02157  1736  09 14 20   FT_LEVEL3  TEXT 'IT IS TIME TO REFLECT UPON YOUR EGO SELF. NOWHERE TO HIDE WHEN THE WALLS ECHO THE YOU THAT WE ALL SEE. FROM THESE WIND TORN RAMPARTS WE SURVEY A THOUSAND FUTURES. BREATH DEEP THE INTOXICATING AROMA OF ENDLESS ENTWINED EMOTIONS. THE SURREAL SEARCH ENDURES.'
02158  1835  00                    BYTE 00
02159  1836  C1 48 20   FT_LEVEL4  TEXT "AH MY FRIENDS! SO LIGHT OF FOOT! SO SWIFT! YOUVE COME THIS FAR. AND NOW, HERE BENEATH THE ANCIENT OMNISCIENT BOUGHS OF THE DECISION TREE, ONE OF YOU MUST DEPART THIS WORLD OF FLESH. ONLY TWO MAY CONTINUE. ONLY YOU CAN DECIDE!"
02160  1917  00                    BYTE 00
02161  1918  D3 54 45   FT_LEVEL5  TEXT "STEP FORWARD! STEP FORWARD! BEYOND THIS LIES YOUR GOAL! BEHOLD! THE STAR TOWERS OF THE ELECTRIC CASTLE. SEE HOW IT EMBRACES THE SKY, HOW INSIGNIFICANT THE MERE MORTAL, DWRFED BY THE MAJESTY OF ITS ELECTRIC EDIFICE!"
02162  19EE  00                    BYTE 00
02163  19EF  01 14 20   FT_LEVEL6  TEXT 'AT LAST YOU ENTER THE NUCLEAR PORTALS OF PSYCHOGENESIS. HERE IN THIS VAST HALL WHERE EVEN SHADOWS FEAR THE LIGHT YOU MUST CONFRONT YOUR PAST. IF YOU HAVE KILLED BEWARE THE GATHERING OF SPIRITS FOR HERE THE DISEMBODIED ASTRAL WORLD BECOMES FLESH ONCE MORE.'
02164  1AEE  00                    BYTE 00
02165  1AEF  19 0F 15   FT_LEVEL7  TEXT 'YOU CRAVED THE ANSWER BUT CAN YOU BEAR THE TRUTH? THE FUTURES DOORED INGRESS! WHAT LIES BEYOND? GUIDE YOUR CHOICE WITH COLLECTIVE WISDOM FOR ONE GATE SEVERS ALL CONNECTIONS. ONE STEP AWAY FROM THE DREAMWORLD OF EVERLASTING EBONY YOU CALL OBLIVION.'
02166  1BE6  00                    BYTE 00
02167  1BE7  09 20 01   FT_END1    TEXT 'I AM OF THE STARS. I AM CALLED FOREVER. IT IS COLD BEYOND YOUR SUN WHERE WE COME FROM. WE PEOPLED YOUR PLANET. BUT THE FINAL EXPERIMENT HAS FAILED. THE EARTH HAS DIED. YOUR WORLD IS AT REST. BUT I OFFER YOU THIS. A FINAL SOLUTION. A CHANCE TO SURVIVE.'
02168  1CE2  00                    BYTE 00
02169  1CE3  17 05 20   FT_END2    TEXT 'WE CAN SAVE YOUR ILL FATED RACE WHO ARE LOST UPON THE OCEAN OF SPACE. THROUGH THEIR EYES WE WILL SEE. WITH THEIR HANDS WE WILL CREATE. IN THEIR WORLD WE WILL BE FREE. WITH OUR MINDS WE WILL SHAPE THEIR FATE. MAKE US WHOLE MIGRATOR SOUL!'
02170  1DCF  00                    BYTE 00
02171  1DD0  14 08 05   FT_END3    TEXT 'THE FATE OF THE FINAL EXPERIMENT IS NOW IN YOUR HANDS'
02172  1E05  00                    BYTE 00
02173  1E06  14 08 05   FT_GAMEOVER TEXT 'THE EXPERIMENT IS OVER. I GROW WEARY. SO TIRED. LET THE DREAM OF CONFUSION LEAD YOU INTO THE VIRGIN LIGHT. BE ALL SEEING, BE BRAVE. BEGONE!'
02174  1E91  00                    BYTE 00
02175  1E92             

******* 142 Label(s) *******
~~~block1{00034} = $0E33 
~~~block1{00035} = $0E6F 
~~~block2{00034} = $0E41 
~~~block2{00035} = $0E7D 
~~~block3{00034} = $0E4F 
~~~block3{00035} = $0E8B 
~~~block4{00034} = $0E5D 
~~~block4{00035} = $0E99 
~~~loop{00003} = $09A5 
~~~loop{00008} = $0A0D 
~~~rasterloop{00000} = $0866 
~~~rasterloop{00009} = $0A1F 
~~~rasterloop{00011} = $0A30 
BOX_SELECTOR_BL = $2A42 
BOX_SELECTOR_BR = $2A43 
BOX_SELECTOR_TL = $2A40 
BOX_SELECTOR_TR = $2A41 
BUTTON_FRAME1 = $2A6B 
BUTTON_FRAME2 = $2A6C 
BUTTON_FRAME3 = $2A6D 
BUTTON_SPRITE_INDEX = $2A68 
BUTTON_X = $2A69 
BUTTON_Y = $2A6A 
BUTTON2_FRAME1 = $2A71 
BUTTON2_FRAME2 = $2A72 
BUTTON2_FRAME3 = $2A73 
BUTTON2_SPRITE_INDEX = $2A6E 
BUTTON2_X = $2A6F 
BUTTON2_Y = $2A70 
CheckForAction = $1195 
CheckForSelectedActionChange = $10AD 
CheckForSpriteCollision = $0EE4 
CheckForWallCollision = $0ED6 
ClearScreen = $0AE5 
DestroyBullet = $0F5B 
DestroyDoor2 = $0AD5 
DOOR_FRAME1 = $2A5B 
DOOR_FRAME2 = $2A5C 
DOOR_FRAME3 = $2A5D 
DOOR_FRAME4 = $2A5E 
DOOR_FRAME5 = $2A5F 
DOOR_SPRITE_INDEX = $2A58 
DOOR_X = $2A59 
DOOR_Y = $2A5A 
DrawForever = $0EA9 
DrawLevel = $0E31 
DrawTitle = $0E6D 
FT_END1 = $1BE7 
FT_END2 = $1CE3 
FT_END3 = $1DD0 
FT_GAMEOVER = $1E06 
FT_LEVEL1 = $13DC 
FT_LEVEL2 = $146B 
FT_LEVEL2P2 = $1534 
FT_LEVEL2P3 = $15CA 
FT_LEVEL2P4 = $169D 
FT_LEVEL3 = $1736 
FT_LEVEL4 = $1836 
FT_LEVEL5 = $1918 
FT_LEVEL6 = $19EF 
FT_LEVEL7 = $1AEF 
GameLoop = $0866 
HandleAction = $100F 
HandleBulletExplosion = $12FA 
HandleDoor2Open = $0A85 
HandleTalk = $1371 
HORI_DOOR_FRAME1 = $2A63 
HORI_DOOR_FRAME2 = $2A64 
HORI_DOOR_FRAME3 = $2A65 
HORI_DOOR_FRAME4 = $2A66 
HORI_DOOR_FRAME5 = $2A67 
HORI_DOOR_SPRITE_INDEX = $2A60 
HORI_DOOR_X = $2A61 
HORI_DOOR_Y = $2A62 
InitCharacterSet = $0E0C 
InitGame = $0853 
InitNewLevel = $0A50 
InitPlayerState = $0F68 
InitSprites = $0D4B 
KillNPC1 = $0F08 
KillNPC2 = $0F14 
KillPlayer = $0F44 
MovePlayer = $0BA9 
NextLevel = $09E7 
NextLevelLoop = $0A1F 
NPC1_SPRITE_INDEX = $2A74 
NPC1_X = $2A76 
NPC1_Y = $2A77 
NPC2_SPRITE_INDEX = $2A75 
NPC2_X = $2A78 
NPC2_Y = $2A79 
OpenDoor1 = $0F20 
OpenDoor2 = $0F32 
PLAYER_BULLET_EXPLOSION1 = $2A53 
PLAYER_BULLET_EXPLOSION2 = $2A54 
PLAYER_BULLET_EXPLOSION3 = $2A55 
PLAYER_BULLET_EXPLOSION4 = $2A56 
PLAYER_BULLET_EXPLOSION5 = $2A57 
PLAYER_BULLET_HORI = $2A4F 
PLAYER_BULLET_NWSE = $2A51 
PLAYER_BULLET_SPRITE_INDEX = $2A4C 
PLAYER_BULLET_SWNE = $2A52 
PLAYER_BULLET_VERT = $2A50 
PLAYER_BULLET_X = $2A4D 
PLAYER_BULLET_Y = $2A4E 
PLAYER_DOWN = $2A4B 
PLAYER_IDLE = $2A47 
PLAYER_LEFT = $2A49 
PLAYER_RIGHT = $2A48 
PLAYER_SPRITE_INDEX = $2A44 
PLAYER_UP = $2A4A 
PLAYER_X = $2A45 
PLAYER_Y = $2A46 
PlayFootstep = $0F78 
PlayLaser = $0FC0 
PlayZap = $0F9C 
ReadJoystick = $0AEB 
ReadJoystick1 = $0B4A 
ResetActionSelector = $116E 
SetActionShoot = $110B 
SetActionTalk = $112C 
SetActionUse = $114D 
TitleLoop = $0847 
ToggleTiles = $13CE 
TurnOffTiles = $13D1 
TurnOnTiles = $13D4 
UpdateButton2Position = $0D24 
UpdateButton2Sprite = $0E05 
UpdateButtonPosition = $0D17 
UpdateButtonSprite = $0DFE 
UpdateDoorPosition = $0CFD 
UpdateDoorSprite = $0DF0 
UpdateHoriDoorPosition = $0D0A 
UpdateHoriDoorSprite = $0DF7 
UpdateLastAimDir = $0FE4 
UpdateNPC1Position = $0D31 
UpdateNPC2Position = $0D3E 
UpdatePlayerAnimationFrame = $0C78 
UpdatePlayerBulletPosition = $0CF0 
UpdatePlayerBulletSprite = $0DE9 
UpdatePlayerSprite = $0DE2 
UpdatePlayerSpritePosition = $0CE3 

******* 36 Unused label(s) *******
@ActCont
@ActionCanProceed
@ActionSwitch
@Block2
@Block3
@Block4
@BulletOverflowLeft
@BulletOverflowRight
@CheckBtn
@CheckBtn
@CheckDown
@CheckDown
@CheckDown
@CheckForBulletOverflow
@CheckForBulletOverflowL
@CheckLeft
@CheckLeft
@CheckLeft
@CheckLeftWrap
@CheckLives
@CheckNPC1Y
@CheckNPC2
@CheckNPC2Y
@CheckRight
@CheckRight
@CheckRight
@CheckUp
@CheckUp
@CheckUp
@CheckWrap
@cont
@Cont
@Continue
@Continue
@continueProcessing
@conttalk
@Destroy
@DestroyDoor1
@Door1OpenFrame1
@Door1OpenFrame2
@Door1OpenFrame3
@Door1OpenFrame4
@Door2OpenFrame1
@Door2OpenFrame2
@Door2OpenFrame3
@Door2OpenFrame4
@DownFrame1
@DrawDialogue
@DyingFrame1
@Exit
@Frame1
@Frame2
@Frame3
@Frame4
@Frame5
@GameOver
@GameOverLoop
@GotoTitle
@HandleAction
@HandleDoor1Open
@HandleDying
@InputBtn
@InputBtn
@InputDown
@InputDown
@InputLeft
@InputLeft
@InputRight
@InputRight
@InputUp
@InputUp
@LeftFrame1
@MoveBullet
@MoveBulletE
@MoveBulletN
@MoveBulletNE
@MoveBulletNW
@MoveBulletS
@MoveBulletSE
@MoveBulletSW
@MoveBulletW
@openD2
@process
@process
@ProcessActionUpdate
@processtalk
@Respawn
@RightFrame1
@SetAimDir
@SetBulletXOverflowOff
@SetBulletXOverflowOn
@SetDown
@SetLeft
@SetRight
@SetUp
@Shoot
@ShootDown
@ShootDownLeft
@ShootDownRight
@ShootLeft
@ShootRight
@ShootUp
@ShootUpLeft
@ShootUpRight
@TalkToNPC1
@TalkToNPC2
@TriggerTalk
@UpdateAction
@UpFrame1
~~~block1{00034}
~~~block1{00035}
~~~block2{00034}
~~~block2{00035}
~~~block3{00034}
~~~block3{00035}
~~~block4{00034}
~~~block4{00035}
~~~loop{00003}
~~~loop{00008}
~~~rasterloop{00000}
~~~rasterloop{00009}
~~~rasterloop{00011}
BUTTON_FRAME2
BUTTON2_FRAME1
BUTTON2_FRAME2
BUTTON2_FRAME3
FT_END1
FT_END2
FT_END3
FT_LEVEL2
FT_LEVEL2P2
FT_LEVEL2P3
FT_LEVEL2P4
FT_LEVEL3
FT_LEVEL4
FT_LEVEL5
FT_LEVEL6
FT_LEVEL7
HORI_DOOR_FRAME5
InitCharacterSet
InitPlayerState
PLAYER_DOWN
PLAYER_LEFT
PLAYER_RIGHT
TurnOffTiles

******* 147 Variable(s) *******
ACTION_SELECTOR_POS1  = $0795
ACTION_SELECTOR_POS10  = $06F7
ACTION_SELECTOR_POS11  = $0745
ACTION_SELECTOR_POS12  = $0747
ACTION_SELECTOR_POS2  = $0797
ACTION_SELECTOR_POS3  = $07E5
ACTION_SELECTOR_POS4  = $07E7
ACTION_SELECTOR_POS5  = $0745
ACTION_SELECTOR_POS6  = $0747
ACTION_SELECTOR_POS7  = $0795
ACTION_SELECTOR_POS8  = $0797
ACTION_SELECTOR_POS9  = $06F5
BG_COLOUR  = $D021
BG_COLOUR1  = $D022
BG_COLOUR2  = $D023
BG_COLOUR3  = $D024
BORDER_COLOUR  = $D020
CharOut  = $FFD2
CHARSET  = $3800
CHARSET_LOOKUP  = $D018
COLOUR_BLACK  = $0000
COLOUR_CYAN  = $0003
COLOUR_LIGHT_BLUE  = $000E
COLOUR_RED  = $0002
COLOUR_WHITE  = $0001
DOOR_SPRITE_DATA  = $2700
DOOR1_OPEN_COUNTER  = $7007
DOOR2_OPEN_COUNTER  = $7008
FOREVER_BLOCK1  = $5800
FOREVER_BLOCK2  = $58FF
FOREVER_BLOCK3  = $59FE
FOREVER_BLOCK4  = $5AFD
FOREVER_CHARSET  = $3000
JOYSTICK_INPUT  = $0002
JOYSTICK_INPUT1  = $0002
JOYSTICK_MASK_BTN  = $0010
JOYSTICK_MASK_DOWN  = $0002
JOYSTICK_MASK_LEFT  = $0004
JOYSTICK_MASK_RIGHT  = $0008
JOYSTICK_MASK_UP  = $0001
JOYSTICK_PORT1  = $DC01
JOYSTICK_PORT2  = $DC00
LEVEL1_BLOCK1  = $5000
LEVEL1_BLOCK2  = $50FF
LEVEL1_BLOCK3  = $51FE
LEVEL1_BLOCK4  = $52FD
LEVEL1_TILE_COUNTER  = $7009
PLAYER_ACTION  = $0001
PLAYER_ACTION_SHOOT  = $0001
PLAYER_ACTION_SWITCH_COOLDOWN  = $7004
PLAYER_ACTION_TALK  = $0002
PLAYER_ACTION_USE  = $0004
PLAYER_BULLET_DIRECTION  = $7005
PLAYER_BULLET_EXPLOSION_COUNTER  = $7006
PLAYER_CURRENT_ACTION  = $7003
PLAYER_DOWN_ANIM1  = $0087
PLAYER_DOWN_ANIM2  = $0088
PLAYER_DYING_ANIM1  = $0089
PLAYER_DYING_ANIM2  = $008A
PLAYER_DYING_COUNTER  = $7000
PLAYER_LEFT_ANIM1  = $0083
PLAYER_LEFT_ANIM2  = $0084
PLAYER_LIVES  = $7001
PLAYER_LIVES_POSITION  = $07C9
PLAYER_MOVED_DOWN  = $0008
PLAYER_MOVED_LEFT  = $0010
PLAYER_MOVED_RIGHT  = $0004
PLAYER_MOVED_THIS_FRAME  = $7002
PLAYER_MOVED_UP  = $0002
PLAYER_RIGHT_ANIM1  = $0081
PLAYER_RIGHT_ANIM2  = $0082
PLAYER_SHOOT_E  = $008D
PLAYER_SHOOT_N  = $008B
PLAYER_SHOOT_NE  = $008C
PLAYER_SHOOT_NW  = $0092
PLAYER_SHOOT_S  = $008F
PLAYER_SHOOT_SE  = $008E
PLAYER_SHOOT_SW  = $0090
PLAYER_SHOOT_W  = $0091
PLAYER_UP_ANIM1  = $0085
PLAYER_UP_ANIM2  = $0086
RASTER_LINE  = $D012
SCREEN_BLOCK1  = $0400
SCREEN_BLOCK2  = $04FF
SCREEN_BLOCK3  = $05FE
SCREEN_BLOCK4  = $06FD
SCREEN_CONTROL  = $D016
SCREEN_CONTROL1  = $D011
SID_ATTACK_DECAY  = $D405
SID_PULSE_HI_WIDTH  = $D403
SID_PULSE_LO_WIDTH  = $D402
SID_SUSTAIN  = $D406
SID_VOICE1_CONTROL  = $D404
SID_VOICE1_HI_FREQ  = $D401
SID_VOICE1_LO_FREQ  = $D400
SID_VOLUME  = $D418
SPRITE_BG_COLLISION  = $D01F
SPRITE_COLLISIONS  = $D01E
SPRITE_ENABLED  = $D015
SPRITE_MULTICOLOUR_ENABLE  = $D01C
SPRITE_OVERFLOW  = $D010
SPRITE0_COLOUR  = $D027
SPRITE0_DATA  = $2000
SPRITE0_POINTER  = $07F8
SPRITE0_X  = $D000
SPRITE0_Y  = $D001
SPRITE1_COLOUR  = $D028
SPRITE1_DATA  = $24C0
SPRITE1_POINTER  = $07F9
SPRITE1_X  = $D002
SPRITE1_Y  = $D003
SPRITE2_COLOUR  = $D029
SPRITE2_POINTER  = $07FA
SPRITE2_X  = $D004
SPRITE2_Y  = $D005
SPRITE3_COLOUR  = $D02A
SPRITE3_DATA  = $2840
SPRITE3_POINTER  = $07FB
SPRITE3_X  = $D006
SPRITE3_Y  = $D007
SPRITE4_COLOUR  = $D02B
SPRITE4_DATA  = $2980
SPRITE4_POINTER  = $07FC
SPRITE4_X  = $D008
SPRITE4_Y  = $D009
SPRITE5_COLOUR  = $D02C
SPRITE5_DATA  = $2980
SPRITE5_POINTER  = $07FD
SPRITE5_X  = $D00A
SPRITE5_Y  = $D00B
SPRITE6_COLOUR  = $D02D
SPRITE6_DATA  = $2000
SPRITE6_POINTER  = $07FE
SPRITE6_X  = $D00C
SPRITE6_Y  = $D00D
SPRITE7_COLOUR  = $D02E
SPRITE7_DATA  = $2000
SPRITE7_POINTER  = $07FF
SPRITE7_X  = $D00E
SPRITE7_Y  = $D00F
StrOut  = $AB1E
TEXT_COLOUR  = $0286
tgt_c64  = $0001
TITLE_BLOCK1  = $5400
TITLE_BLOCK2  = $54FF
TITLE_BLOCK3  = $55FE
TITLE_BLOCK4  = $56FD
******* -61 Unused variables(s) *******
BG_COLOUR1
BG_COLOUR2
BG_COLOUR3
CHARSET
COLOUR_CYAN
DOOR_SPRITE_DATA
FOREVER_BLOCK1
FOREVER_BLOCK2
FOREVER_BLOCK3
FOREVER_BLOCK4
FOREVER_CHARSET
LEVEL1_BLOCK1
LEVEL1_BLOCK2
LEVEL1_BLOCK3
LEVEL1_BLOCK4
RASTER_LINE
SCREEN_BLOCK1
SCREEN_BLOCK2
SCREEN_BLOCK3
SCREEN_BLOCK4
SCREEN_CONTROL1
SID_ATTACK_DECAY
SID_PULSE_HI_WIDTH
SID_PULSE_LO_WIDTH
SID_SUSTAIN
SID_VOICE1_CONTROL
SID_VOICE1_HI_FREQ
SID_VOICE1_LO_FREQ
SID_VOLUME
SPRITE0_DATA
SPRITE1_DATA
SPRITE2_COLOUR
SPRITE3_COLOUR
SPRITE3_DATA
SPRITE4_COLOUR
SPRITE4_DATA
SPRITE5_COLOUR
SPRITE5_DATA
SPRITE6_COLOUR
SPRITE6_DATA
SPRITE7_COLOUR
SPRITE7_DATA
StrOut
tgt_c64
TITLE_BLOCK1
TITLE_BLOCK2
TITLE_BLOCK3
TITLE_BLOCK4

